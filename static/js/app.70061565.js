(function(t){function e(e){for(var r,i,s=e[0],l=e[1],c=e[2],f=0,d=[];f<s.length;f++)i=s[f],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r]);u&&u(e);while(d.length)d.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,s=1;s<n.length;s++){var l=n[s];0!==a[l]&&(r=!1)}r&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},a={app:0},o=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=l;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var r=n("85ec"),a=n.n(r);a.a},"2db6":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-app",{ref:"mainview",staticStyle:{position:"relative"}},[r("info-tooltip",{attrs:{left:t.tooltip.left,top:t.tooltip.top,show:t.tooltip.show,content:t.tooltip.content}}),r("v-content",[r("v-container",{staticClass:"core-view fill-height",attrs:{fluid:"",id:"nlpvis"}},[r("v-row",{staticClass:"fill-height"},[r("v-col",{staticClass:"fill-height py-0 pr-0",attrs:{cols:"4"}},[r("v-card",{directives:[{name:"intro-step",rawName:"v-intro-step",value:2,expression:"2"},{name:"intro",rawName:"v-intro",value:"In the distribution view, user can identify important samples and words for further analysis.",expression:"'In the distribution view, user can identify important samples and words for further analysis.'"}],staticClass:"nlpvis-view",attrs:{height:"40%"}},[r("v-toolbar",{attrs:{dense:"",flat:""}},[r("v-btn-toggle",{staticClass:"nlpvis-tab",attrs:{dense:""},model:{value:t.left_top_view,callback:function(e){t.left_top_view=e},expression:"left_top_view"}},[r("v-btn",{attrs:{value:"matrix"}},[r("span",{staticClass:"nlpvis-title"},[t._v("Class")])]),r("v-btn",{attrs:{value:"corpus"}},[r("span",{staticClass:"nlpvis-title"},[t._v("Distribution")])])],1),r("v-spacer"),r("v-checkbox",{staticStyle:{"padding-top":"12px"},attrs:{color:"darkgray"},scopedSlots:t._u([{key:"prepend",fn:function(){return[r("v-img",{attrs:{width:"115px",height:"24px",src:n("8d3c")}})]},proxy:!0}]),model:{value:t.is_lasso_select_all,callback:function(e){t.is_lasso_select_all=e},expression:"is_lasso_select_all"}})],1),r("hr"),r("svg",{directives:[{name:"intro-step",rawName:"v-intro-step",value:1,expression:"1"},{name:"intro",rawName:"v-intro",value:"Click on an element in the matrix to start the analysis of any two classes.",expression:"'Click on an element in the matrix to start the analysis of any two classes.'"}],staticClass:"ma-1",attrs:{id:"overview-svg"}},[r("g",{directives:[{name:"show",rawName:"v-show",value:"corpus"==t.left_top_view,expression:"left_top_view == 'corpus'"}],attrs:{id:"overview-g"}}),r("word-group",{directives:[{name:"show",rawName:"v-show",value:"corpus"==t.left_top_view,expression:"left_top_view == 'corpus'"}],attrs:{tooltip:t.enable_tooltip,transform:"translate("+t.bubble.left+",0)",data:t.overviewWords,interaction:t.enable_word_filter?"filter":"DAG"}}),r("g",{directives:[{name:"show",rawName:"v-show",value:"matrix"==t.left_top_view,expression:"left_top_view == 'matrix'"}],attrs:{id:"matrix-g"}},[r("g",{attrs:{transform:"translate(30, 10)"}},[r("image",{attrs:{x:"0",y:"18",width:"320",height:"10",preserveAspectRatio:"none","xlink:href":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAABCAYAAAAxWXB3AAAAH0lEQVQ4T2P8////fwYGBgYoNUpDgmM0HEbDYUSkAwCp0H+QW+DsjwAAAABJRU5ErkJggg=="}}),r("g",{attrs:{transform:"translate(0,28)",fill:"none","font-size":"10","font-family":"sans-serif","text-anchor":"middle"}},[r("g",{staticClass:"tick",attrs:{opacity:"1",transform:"translate(0.5,0)"}},[r("line",{attrs:{stroke:"currentColor",y2:"6",y1:"-10"}}),r("text",{attrs:{fill:"currentColor",y:"9","font-size":"18px","font-family":"Arial",dy:"0.71em"}},[t._v("0.0")])]),r("g",{staticClass:"tick",attrs:{opacity:"1",transform:"translate(143.5,0)"}},[r("line",{attrs:{stroke:"currentColor",y2:"6",y1:"-10"}}),r("text",{attrs:{fill:"currentColor",y:"9","font-size":"18px","font-family":"Arial",dy:"0.71em"}},[t._v("0.2")])]),r("g",{staticClass:"tick",attrs:{opacity:"1",transform:"translate(203.5,0)"}},[r("line",{attrs:{stroke:"currentColor",y2:"6",y1:"-10"}}),r("text",{attrs:{"font-size":"18px","font-family":"Arial",fill:"currentColor",y:"9",dy:"0.71em"}},[t._v("0.4")])]),r("g",{staticClass:"tick",attrs:{opacity:"1",transform:"translate(249.5,0)"}},[r("line",{attrs:{stroke:"currentColor",y2:"6",y1:"-10"}}),r("text",{attrs:{fill:"currentColor",y:"9","font-size":"18px","font-family":"Arial",dy:"0.71em"}},[t._v("0.6")])]),r("g",{staticClass:"tick",attrs:{opacity:"1",transform:"translate(287.5,0)"}},[r("line",{attrs:{stroke:"currentColor",y2:"6",y1:"-10"}}),r("text",{attrs:{fill:"currentColor","font-size":"18px","font-family":"Arial",y:"9",dy:"0.71em"}},[t._v("0.8")])]),r("text",{attrs:{x:"0",y:"-16","font-size":"18px","font-family":"Arial",fill:"currentColor","text-anchor":"start","font-weight":"bold"}},[t._v("Percentage")])])])])],1)],1),r("v-card",{directives:[{name:"intro",rawName:"v-intro",value:"In the sample list, user can examine multiple samples in terms of their text content, class labels, and prediction scores.",expression:"'In the sample list, user can examine multiple samples in terms of their text content, class labels, and prediction scores.'"},{name:"intro-step",rawName:"v-intro-step",value:4,expression:"4"}],staticClass:"nlpvis-view pa-1 mt-2",attrs:{"min-height":"calc(53% - 48px)"}},[r("v-toolbar",{attrs:{dense:"",flat:""}},[r("v-btn-toggle",{staticClass:"nlpvis-tab",attrs:{dense:""},model:{value:t.left_bottom_view,callback:function(e){t.left_bottom_view=e},expression:"left_bottom_view"}},[r("v-btn",{attrs:{value:"samples"}},[r("span",{staticClass:"nlpvis-title"},[t._v("Sample List")])])],1),r("v-spacer"),t.search_expand?[r("v-combobox",{attrs:{chips:"",clearable:"",label:"Enter a word or sample number here",multiple:"",solo:""},scopedSlots:t._u([{key:"selection",fn:function(e){var n=e.attrs,a=e.item,o=e.selected;return[r("v-chip",t._b({attrs:{"input-value":o,close:""},on:{click:function(e){return t.clickSearchItem(a)},contextmenu:function(e){return e.preventDefault(),t.rightClickSearchItem(a)},"click:close":function(e){return t.removeSearchItem(a)}}},"v-chip",n,!1),[r("strong",[t._v(t._s(a))]),t._v(" "),r("span",[t._v(t._s(isNaN(+a)?"(Word)":"(Sample)"))])])]}}]),model:{value:t.chips,callback:function(e){t.chips=e},expression:"chips"}})]:[r("span",{staticClass:"pa-1 nlpvis-title disabled"}),"corpus"==t.left_top_view?t._l(t.selected_class,(function(e){return r("span",{key:"legend"+e,staticClass:"color-legend",style:"--color: "+t.color_scheme[e]},[t._v(" "+t._s(t.labels[e]&&t.labels[e].name)+" ")])})):t._e()],r("v-btn",{attrs:{icon:""},on:{click:function(e){return t.onClickSearch()}}},[r("v-icon",{attrs:{size:"26"}},[t._v("mdi-magnify")])],1)],2),r("hr"),r("v-simple-table",{ref:"simpletable",staticStyle:{"overflow-x":"hidden","max-height":"calc(52vh - 96px)","max-width":"100%","overflow-y":"scroll"},attrs:{dense:""},scopedSlots:t._u([{key:"default",fn:function(){return[r("thead",[r("tr",[r("th",{staticClass:"text-left nlpvis-text pa-1",staticStyle:{"white-space":"nowrap"}},[t._v(" ID"),r("v-icon",{staticStyle:{color:"#444"},attrs:{size:"18"}},[t._v("mdi-menu-swap")])],1),r("th",{staticClass:"text-left nlpvis-text pa-1"},[t._v(" Passage"),r("v-icon",{staticStyle:{color:"#444"},attrs:{size:"18"}},[t._v("mdi-menu-swap")])],1),r("th",{staticClass:"text-left nlpvis-text pa-1",staticStyle:{"white-space":"nowrap"}},[t._v(" Label"),r("v-icon",{staticStyle:{color:"#444"},attrs:{size:"18"}},[t._v("mdi-menu-swap")])],1),r("th",{staticClass:"text-left nlpvis-text pa-1",staticStyle:{"white-space":"nowrap"}},[t._v(" Score"),r("v-icon",{staticStyle:{color:"#444"},attrs:{size:"18"}},[t._v("mdi-menu-swap")])],1),r("th",{staticClass:"text-left nlpvis-text pa-1",staticStyle:{"white-space":"nowrap"}},[t._v(" ..."),r("v-icon",{staticStyle:{color:"#444"},attrs:{size:"18"}},[t._v("mdi-menu-swap")])],1)])]),r("tbody",{staticStyle:{"overflow-x":"hidden","max-height":"calc(52% - 96px)","overflow-y":"scroll"}},[t._l(t.view_samples,(function(e){return[e.show_filter?r("tr",{key:"filter"+e.index},[r("td",{staticClass:"pa-1 nlpvis-text"}),r("td",{staticClass:"pa-1 nlpvis-text",staticStyle:{color:"#777"}},[t._v(" There are "+t._s(t.filter_info.pos)+" negative samples and "+t._s(t.filter_info.neg)+' positive samples include "'+t._s(t.filter_info.word)+'" ')]),r("td",{staticClass:"pa-1 nlpvis-text",staticStyle:{"white-space":"nowrap"}}),r("td",{staticClass:"pa-1 nlpvis-text"}),r("td",{staticClass:"pa-1 nlpvis-text"})]):t._e(),r("tr",{key:e.index,on:{mouseenter:function(n){return t.highlightGrid([e.index])},mouseleave:function(e){return t.highlightGrid(null)},click:function(n){return t.addSentenceDAG(e.index)}}},[r("td",{staticClass:"pa-1 nlpvis-text"},[t._v(t._s(e.index))]),r("td",{staticClass:"pa-1 nlpvis-text",style:{color:"N/A"==e.pred?"#777":"black"}},t._l(e.text,(function(e,n){return r("span",{key:n,style:{background:e[1]?"orange":"none"}},[t._v(" "+t._s(e[0])+" ")])})),0),r("td",{staticClass:"pa-1 nlpvis-text",staticStyle:{"white-space":"nowrap"}},[t._v(" "+t._s(e.label)+" "),r("span",{staticStyle:{display:"inline-block",width:"16px",height:"16px"},style:{"background-color":t.getLabelColor(e.label)}})]),r("td",{staticClass:"pa-1 nlpvis-text"},[t._v(" "+t._s(isNaN(e.score)?"N/A":Number(e.score).toFixed(2))+" ")]),r("td",{staticClass:"pa-1 nlpvis-text"},[e.pred==e.label?r("v-icon",[t._v("mdi-check")]):"N/A"!=e.pred?r("v-icon",[t._v("mdi-close")]):t._e()],1)])]}))],2)]},proxy:!0}])})],1),r("v-card",{staticClass:"nlpvis-script pa-1 mt-2",attrs:{height:"calc(7% + 8px)"}},[r("v-toolbar",{staticStyle:{"margin-top":"2.5%"},attrs:{flat:"",dense:""}},[r("v-select",{staticClass:"nlpvis-text",staticStyle:{"margin-top":"3.5%"},attrs:{items:t.datasets,label:"SST-2",outlined:""}}),r("v-select",{staticClass:"nlpvis-text ml-2",staticStyle:{"margin-top":"3.5%"},attrs:{items:t.models,label:"12-layer BERT",outlined:""}}),r("v-dialog",{attrs:{transition:"dialog-bottom-transition","max-width":t.config.dialog_width},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,a=e.attrs;return[r("v-btn",t._g(t._b({staticStyle:{"margin-left":"4px"},attrs:{icon:"",large:""},on:{click:function(e){return t.onDialogOpen()}}},"v-btn",a,!1),n),[r("v-icon",[t._v("mdi-cog")])],1)]}},{key:"default",fn:function(e){return[r("v-card",{attrs:{width:"600"}},[r("v-toolbar",{staticClass:"text-h4",attrs:{color:"secondary",dark:""}},[t._v("Color and parameter settings")]),r("v-card-text",[r("v-radio-group",{scopedSlots:t._u([{key:"label",fn:function(){return[r("div",{staticClass:"text-h5"},[r("strong",[t._v("Color scheme")])])]},proxy:!0}],null,!0),model:{value:t.current_color_scheme,callback:function(e){t.current_color_scheme=e},expression:"current_color_scheme"}},t._l(t.color_candidates,(function(e,n){return r("v-radio",{key:"color"+n,attrs:{value:n},scopedSlots:t._u([{key:"label",fn:function(){return[r("div",{staticClass:"text-h6"},0==n?[r("strong",[t._v(" Default ")])]:[r("strong",[t._v(" Colorblind-safe ")])]),r("div",{staticClass:"ml-2"},t._l(e,(function(t,e){return r("span",{key:"legend"+n+"_"+e,staticClass:"color-legend-type2",style:"--color: "+t})})),0)]},proxy:!0}],null,!0)})})),1),r("hr",{staticClass:"mt-2 mb-2"}),r("div",{staticClass:"text-h5 mt-4"},[r("strong",[t._v("Parameters")])]),r("v-subheader",{staticClass:"text-h6  mt-2 mb-2"},[t._v(" Î¾ for differentiating class-relevant and -irrelevant words. ")]),r("svg",{ref:"xi_distribution",attrs:{width:t.config.histogram_width,height:t.config.histogram_height}}),r("v-slider",{attrs:{max:t.parameters.xi_range[1],min:t.parameters.xi_range[0],step:(t.parameters.xi_range[1]-t.parameters.xi_range[0])/1e3},scopedSlots:t._u([{key:"append",fn:function(){return[r("v-text-field",{staticClass:"mt-0 pt-0",staticStyle:{width:"60px"},attrs:{type:"number"},model:{value:t.xi_threshold,callback:function(e){t.xi_threshold=e},expression:"xi_threshold"}})]},proxy:!0}],null,!0),model:{value:t.xi_threshold,callback:function(e){t.xi_threshold=e},expression:"xi_threshold"}})],1),r("v-card-actions",{staticClass:"justify-end"},[r("v-btn",{attrs:{secondary:""},on:{click:function(t){e.value=!1}}},[t._v("Save")]),r("v-btn",{attrs:{default:""},on:{click:function(t){e.value=!1}}},[t._v("Close")])],1)],1)]}}])})],1)],1)],1),r("v-col",{staticClass:"fill-height py-0",attrs:{cols:"8"}},[r("v-card",{directives:[{name:"intro-step",rawName:"v-intro-step",value:3,expression:"3"},{name:"intro",rawName:"v-intro",value:"In the word contribution view, it shows how words are leveraged at different layers for prediction.",expression:"'In the word contribution view, it shows how words are leveraged at different layers for prediction.'"}],staticClass:"nlpvis-view",attrs:{height:"40%"}},[r("v-toolbar",{attrs:{dense:"",flat:""}},[r("v-btn-toggle",{staticClass:"nlpvis-tab",attrs:{dense:""},model:{value:t.right_top_view,callback:function(e){t.right_top_view=e},expression:"right_top_view"}},[r("v-btn",{attrs:{value:"word"}},[r("span",{staticClass:"nlpvis-title"},[t._v("Word Contribution")])])],1),r("v-spacer"),r("v-icon",{staticClass:"px-2",attrs:{size:"26",color:t.show_trending_down?"#333":"#ccc"},on:{click:function(e){t.show_trending_down=!t.show_trending_down}}},[t._v(" mdi-trending-down ")]),r("v-icon",{staticClass:"px-2",attrs:{size:"26",color:t.show_trending_up?"#333":"#ccc"},on:{click:function(e){t.show_trending_up=!t.show_trending_up}}},[t._v(" mdi-trending-up ")])],1),r("hr"),r("svg",{staticClass:"ma-1",attrs:{id:"linechart-svg"}},[r("g",{directives:[{name:"show",rawName:"v-show",value:t.is_wordview_init,expression:"is_wordview_init"}],attrs:{id:"linechart-g"}},[t.show_trending_up?[t._l(t.trending_up_lines,(function(t,e){return r("path",{key:e,staticStyle:{opacity:"1"},attrs:{transform:"translate(0, 0)",d:t,fill:"none",stroke:"#dbdedb","stroke-width":"15px"}})})),t._l(t.trending_up_underlines,(function(e,n){return r("g",{key:n,attrs:{transform:"translate(0, 0)"}},t._l(e,(function(t,e){return r("line",{key:e,staticStyle:{opacity:"1","stroke-width":"3px",stroke:"gray"},attrs:{fill:"none",x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2}})})),0)}))]:t._e(),t.show_trending_down?[t._l(t.trending_down_lines,(function(t,e){return r("path",{key:e,staticStyle:{opacity:"1"},attrs:{transform:"translate(0, 0)",d:t,fill:"none",stroke:"#dbdedb","stroke-width":"15px"}})})),t._l(t.trending_down_underlines,(function(e,n){return r("g",{key:n,attrs:{transform:"translate(0, 0)"}},t._l(e,(function(t,e){return r("line",{key:e,staticStyle:{opacity:"1","stroke-width":"3px",stroke:"gray"},attrs:{fill:"none",x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2}})})),0)}))]:t._e(),r("word-group",{attrs:{tooltip:t.enable_tooltip,transform:"translate("+t.linechart.padding+",0)",data:t.infolossWords,highlight:t.enable_word_highlight&&"sentence"==t.current_viewtype,highlight_text:t.current_text,interaction:t.enable_word_filter?"filter":"DAG"}})],2)])],1),r("v-card",{directives:[{name:"intro-step",rawName:"v-intro-step",value:5,expression:"5"},{name:"intro",rawName:"v-intro",value:"In the information flow, user can analyze how NLP models process a sample through layers in a unified way.",expression:"'In the information flow, user can analyze how NLP models process a sample through layers in a unified way.'"}],staticClass:"nlpvis-view pa-1 mt-2",attrs:{height:"calc(53% - 48px)"}},[r("v-toolbar",{attrs:{dense:"",flat:""}},[r("v-btn-toggle",{staticClass:"nlpvis-tab",attrs:{dense:""},model:{value:t.right_bottom_view,callback:function(e){t.right_bottom_view=e},expression:"right_bottom_view"}},[r("v-btn",{attrs:{value:"info_flow"},on:{click:function(e){return t.changeRightBottomView()}}},[r("span",{staticClass:"nlpvis-title"},[t._v("Information Flow")])]),r("v-btn",{directives:[{name:"intro-step",rawName:"v-intro-step",value:6,expression:"6"},{name:"intro",rawName:"v-intro",value:"In the word context view, user can gain a deep understanding of a word by revealing how the model processes the word based on its context.",expression:"'In the word context view, user can gain a deep understanding of a word by revealing how the model processes the word based on its context.'"}],attrs:{value:"word_ctx"},on:{click:function(e){return t.changeRightBottomView()}}},[r("span",{staticClass:"nlpvis-title"},[t._v("Word Context")])])],1),r("v-spacer"),"corpus"==t.left_top_view?[r("span",{staticClass:"color-legend",style:"--color: rgb(153,153,153)"},[t._v(" Irrelevant ")]),t._l(t.selected_class,(function(e){return r("span",{key:"legend"+e,staticClass:"color-legend",style:"--color: "+t.color_scheme[e]},[t._v(" "+t._s(t.labels[e]&&t.labels[e].name)+" ")])}))]:t._e()],2),r("hr"),r("svg",{attrs:{id:"network-svg"}})],1),r("v-card",{staticClass:"nlpvis-script pa-1 mt-2",attrs:{height:"calc(7% + 8px)"}},[r("v-img",{attrs:{height:"76",width:"1160",src:n("a760")}})],1)],1)],1)],1)],1)],1)},o=[],i=(n("99af"),n("4de4"),n("0481"),n("4160"),n("c975"),n("a15b"),n("d81d"),n("13d5"),n("fb6a"),n("a434"),n("4069"),n("a9e3"),n("b680"),n("d3b7"),n("ac1f"),n("6062"),n("3ca3"),n("5319"),n("159b"),n("ddb0"),n("2b3d"),n("b85c")),s=n("2909"),l=(n("96cf"),n("1da1")),c=n("5530"),u=n("5698");n("b0c0");function f(){var t,e="x",n=200,r=30,a={top:0,bottom:0,left:0,right:0},o=u["y"][0],i="category",l=null,c="linear",d=60,h=null,p=function(){},g=function(){};function y(f){var p=f.selection?f.selection():f,g=p.append("g").attr("transform","translate(".concat(a.left,", ").concat(a.top,")")),y=l.map((function(t){return t[e]}));if(h)if("time"==i){var v=u["f"](l,(function(t){return new Date(y)}));t=u["x"]().domain(v).nice(),t.range([0,h.length])}else if("number"==i){var x=h;t=u["r"]().domain(x).nice(),h=t.ticks(Math.min(x[1]+1,d)),t.range([0,h.length])}else{var m={};h.forEach((function(t,e){return m[t]=e})),t=function(t){return m[t]}}else if("time"==i){var w=u["f"](y,(function(t){return new Date(t)}));t=u["x"]().domain(w).nice(),h=t.ticks(d),t.range([0,h.length])}else if("number"==i){y=y.sort((function(t,e){return t-e}));var b=y[~~(.95*y.length)],_=y[~~(.05*y.length)];_>0&&_<=.01&&(_=0),b<1&&b>.9&&(b=1),y=y.map((function(t){return t>=_&&t<=b?t:Math.random()*(b-_)+_}));var k=u["f"](y);t=u["r"]().domain(k).nice(),h=t.ticks(d),t.range([0,h.length])}else{h=Object(s["a"])(new Set(y));var C={};h.forEach((function(t,e){return C[t]=e})),t=function(t){return C[t]}}var M=h.map((function(t){return{name:t,count:0}}));y.forEach((function(e){M[Math.min(h.length-1,~~t(e))].count+=1}));var O,S=u["q"]().domain(h).range([0,n]).padding(.2),A=S.bandwidth();O="linear"==c?u["r"]().domain([0,u["m"](M,(function(t){return t.count}))]).range([0,r]):u["w"]().domain([0,u["m"](M,(function(t){return t.count}))]).range([0,r]),g.append("g").attr("transform","translate(0, ".concat(r+5,")"));g.selectAll("rect").data(M).enter().append("rect").attr("class","bar").attr("x",(function(t){return S(t.name)})).attr("y",(function(t){return r-O(t.count)})).attr("width",A).attr("height",(function(t){return O(t.count)})).attr("fill",o).attr("opacity",1)}return f.prototype.cache={},y.x=function(t){return arguments.length?(e=t,y):e},y.width=function(t){return arguments.length?(n=t,y):n},y.height=function(t){return arguments.length?(r=t,y):r},y.margin=function(t){return arguments.length?(a=t,y):a},y.datatype=function(t){return arguments.length?(i=t,y):i},y.color=function(t){return arguments.length?(o=t,y):o},y.data=function(t){return arguments.length?(l=t,y):l},y.brushend=function(t){return arguments.length?(on_brushend=t,y):on_brushend},y.scale=function(t){return arguments.length?(c=t,y):c},y.mousemove=function(t){return arguments.length?(p=t,y):p},y.mouseout=function(t){return arguments.length?(g=t,y):g},y.valueTicks=function(t){return arguments.length?(h=t,y):h},y}var d=f,h=n("2f62"),p=n("3723"),g=n("bc3a"),y=n.n(g);function v(){var t=[256,256],e=null,n=I,r=W,a=E,o=G,s=G,c=N,f=L,d=D,h=R,p=z,g=j,y=function(t){return 0},v=[],x=[],m=4,w=30,b={},_=function(t){return t-t%w},k=[],C=[],M=[],O=0;function S(){var t;function e(e){var n,r=u["p"](t,(function(t){return t.x}),(function(t){return t.y})),a=Object(i["a"])(t);try{var o=function(){var t=n.value;r.visit((function(e,n,r,a,o){var i=!1;if(e.data&&e.data!==t){var s,l,u,f=t.x-e.data.x,d=t.y-e.data.y,h=c+(e.data.width+t.width)/2,p=c+(e.data.height+t.height)/2,g=Math.abs(f),y=Math.abs(d);g<h&&y<p&&(s=Math.sqrt(f*f+d*d),l=(g-h)/s,u=(y-p)/s,Math.abs(l)>Math.abs(u)?l=0:u=0,t.x-=f*=l,t.y-=d*=u,e.data.x+=f,e.data.y+=d,i=!0)}return i}))};for(a.s();!(n=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}}return e.initialize=function(e){return t=e},e}function A(t){return"function"===typeof t?t:function(){return t}}function j(t){return 0}function R(t){return 0}function z(t){return 0}function I(t){return t.text}function W(){return"Arial"}function G(){return"normal"}function E(t){return Math.sqrt(t.value)}function L(t){return[0,1,.5]}function D(t){return[0,1,.5]}function N(){return 1}return b.addRect=function(t,e,n,r){for(var a=[t,e,n,r],o=_(t);o<n;o+=w)k[o]||(k[o]=[]),k[o].push(a);for(var i=_(e);i<r;i+=w)C[i]||(C[i]=[]),C[i].push(a);M.push(a)},b.checkVectical=function(e){e=Array.isArray(e)?e.sort():[e];for(var n=[],r=0;r<e.length;++r){var a=e[r],o=_(e[r]);if(C[o]){var s,l=Object(i["a"])(C[o]);try{for(l.s();!(s=l.n()).done;){var c=s.value;c[1]<a&&a<c[3]&&n.push([c[0],c[2]])}}catch(p){l.e(p)}finally{l.f()}}}n=n.sort((function(t,e){return t[0]-e[0]}));for(var u=[],f=0,d=0,h=0;h<n.length;++h)n[h][0]<=d?n[h][1]>d&&(d=n[h][1]):(u.push(d),f=n[h][0],d=n[h][1],u.push(f));return u.push(d),u.push(t[1]),u},b.checkHorizontal=function(e){e=Array.isArray(e)?e.sort():[e];for(var n=[],r=0;r<e.length;++r){var a=e[r],o=_(e[r]);if(k[o]){var s,l=Object(i["a"])(k[o]);try{for(l.s();!(s=l.n()).done;){var c=s.value;c[0]<a&&a<c[2]&&n.push([c[1],c[3]])}}catch(p){l.e(p)}finally{l.f()}}}n=n.sort((function(t,e){return t[0]-e[0]}));for(var u=[],f=0,d=0,h=0;h<n.length;++h)n[h][0]<=d?n[h][1]>d&&(d=n[h][1]):(u.push(d),f=n[h][0],d=n[h][1],u.push(f));return u.push(d),u.push(t[0]),u},b.start=function(){var w=Object(l["a"])(regeneratorRuntime.mark((function l(w){var _,k,C,A,j,R,z,I,W,G,E,L,D,N,T,B,P,V,F,$,H,q,Y,X,U,J,Q,Z,K,tt,et,nt,rt,at,ot,it,st,lt,ct;return regeneratorRuntime.wrap((function(l){while(1)switch(l.prev=l.next){case 0:j=function(t){A.save(),A.font="".concat(t.style," ").concat(t.weight," ").concat(t.size,"px ").concat(t.font);var e=A.measureText(t.text),n=e.actualBoundingBoxRight+e.actualBoundingBoxLeft,r=e.actualBoundingBoxAscent+1,a=e.actualBoundingBoxRight-e.actualBoundingBoxLeft,o=e.actualBoundingBoxDescent/2;return A.restore(),[n,r,a,o]},new Date,_=64,k=2048,"undefined"!==typeof document?(C=document.createElement("canvas"),C.width=1,C.height=1,C.width=_<<5,C.height=k):C=new Canvas(_<<5,k),A=C.getContext("2d"),A.fillStyle=A.strokeStyle="red",A.textAlign="center",x.forEach((function(t,e){t.text=n(t,e),t.font=r(t,e),t.size=a(t,e),t.style=o(t,e),t.weight=s(t,e),t.padding=c(t,e),t.rangex=f(t,e),t.rangey=d(t,e),t.expandx=h(t,e),t.expandy=p(t,e),t.flexible=g(t,e)})),R=x,R.forEach((function(e){var n=j(e);if(e.width=n[0]+e.padding+e.expandx,e.height=n[1]+e.padding+e.expandy,e.flexible&&e.width>.95*t[0]){var r=n[0]/(t[0]-e.padding-e.expandx);e.width=n[0]/r*.95+e.padding+e.expandx,e.height=n[1]/r*.95+e.padding+e.expandy,e.size=e.size/r}e.dx=e.padding/2-n[2],e.dy=e.padding/2+n[3],e.display=!1})),R.sort((function(t,e){return y(e)!=y(t)?y(e)-y(t):e.size!=t.size?e.size-t.size:e.value-t.value})),e||(e=[t[0]/2,t[1]/2]),z=Object(i["a"])(v);try{for(z.s();!(I=z.n()).done;)W=I.value,b.addRect(W.y0,W.x0,W.y1,W.x1)}catch(ut){z.e(ut)}finally{z.f()}O=v.length,G=0;case 16:if(!(G<R.length)){l.next=93;break}if(E=R[G],!(E.text.length<=1)){l.next=21;break}return E.display=!1,l.abrupt("continue",90);case 21:L=E.rangey[2]*t[1],D=E.rangey[0]*t[1],N=E.rangey[1]*t[1],T=E.rangex[0]*t[0],B=E.rangex[1]*t[0],P=0,V=void 0,F=void 0,$=0;case 28:if(!(L-$>=D||L+$<=N)){l.next=80;break}if(!P){l.next=31;break}return l.abrupt("break",80);case 31:H=-1;case 32:if(!(H<=1)){l.next=77;break}if(!P){l.next=35;break}return l.abrupt("break",77);case 35:if(F=L+$*H,!(F<D||F>N||F-E.height/2<0||F+E.height/2>t[1]||0==$&&1==H)){l.next=38;break}return l.abrupt("continue",74);case 38:q=b.checkHorizontal([F-E.height/2,F-E.height/4,F,F+E.height/4,F+E.height/2]),Y=-1,X=0;case 41:if(!(X<q.length)){l.next=57;break}if(U=Math.max(q[X],T),J=Math.min(q[X+1],B),U+=E.width/2,J-=E.width/2,!(J<U)){l.next=47;break}return l.abrupt("continue",54);case 47:if(!(U<=e[0]&&e[0]<=J)){l.next=53;break}return Y=e[0],P=1,l.abrupt("break",57);case 53:J<=e[0]?Y=J:U>=e[0]&&Math.abs(e[0]-U)<Math.abs(e[0]-Y)&&(Y=U);case 54:X+=2,l.next=41;break;case 57:if(-1==Y){l.next=74;break}P=1,Q=b.checkVectical([Y-E.width/2,Y-E.width/4,Y,Y+E.width/4,Y+E.width/2]),Z=0;case 61:if(!(Z<Q.length)){l.next=70;break}if(K=Math.max(Q[Z],D),tt=Math.min(Q[Z+1],N),K+=E.height/2,tt-=E.height/2,!(F<K||F>tt)){l.next=67;break}return l.abrupt("continue",67);case 67:Z+=2,l.next=61;break;case 70:V=Y-E.width/2,F+=E.height/2,E.display=!0,b.addRect(F-E.height,V,F,V+E.width);case 74:H+=2,l.next=32;break;case 77:$+=m,l.next=28;break;case 80:if(E.display||!(E.expandx>0)){l.next=90;break}et=G+1;case 82:if(!(et<R.length)){l.next=90;break}if(0!=R[et].expandx){l.next=87;break}return R[et].expandx=E.expandx,R[et].width+=E.expandx,l.abrupt("break",90);case 87:++et,l.next=82;break;case 90:++G,l.next=16;break;case 93:for(nt=0,rt=O;nt<R.length;++nt)R[nt].display&&(at=R[nt].padding/2,R[nt].width-=R[nt].padding,R[nt].height-=R[nt].padding,M[rt][2]-=at,M[rt][3]-=at,++rt);ot=R,R=R.filter((function(t){return t.display})),it=u["g"](R).force("x",u["h"](e[0]/2).strength(.05)).force("y",u["i"](e[1]/2).strength(.05)).force("collide",S()),st=0;case 98:if(!(st<1)){l.next=104;break}return l.next=101,it.tick();case 101:++st,l.next=98;break;case 104:for(R=ot,lt=0,ct=O;lt<R.length;++lt)R[lt].display?(R[lt].x=M[ct][1]+.66*R[lt].expandx-R[lt].padding/2+R[lt].dx,R[lt].y=M[ct][0]+R[lt].height+R[lt].expandy-R[lt].padding/2,R[lt].dx=0,R[lt].dy=0,++ct):(R[lt].x=e[0]-R[lt].width/2-R[lt].padding/2,R[lt].y=t[1]*R[lt].rangey[2]+R[lt].height/2-R[lt].padding/2);new Date,w(R);case 108:case"end":return l.stop()}}),l)})));return function(t){return w.apply(this,arguments)}}(),b.data=function(t){return arguments.length?(x=t,b):x},b.center=function(t){return arguments.length?(e=[+t[0],+t[1]],b):e},b.size=function(e){return arguments.length?(t=[+e[0],+e[1]],k=[],C=[],b):t},b.font=function(t){return arguments.length?(r=A(t),b):r},b.fontStyle=function(t){return arguments.length?(o=A(t),b):o},b.fontWeight=function(t){return arguments.length?(s=A(t),b):s},b.barriers=function(t){return arguments.length?(v=t,b):v},b.text=function(t){return arguments.length?(n=A(t),b):n},b.expandx=function(t){return arguments.length?(h=A(t),b):h},b.flexible=function(t){return arguments.length?(g=A(t),b):g},b.keepFirst=function(t){return arguments.length?(y=A(t),b):y},b.expandy=function(t){return arguments.length?(p=A(t),b):p},b.rangex=function(t){return arguments.length?(f=A(t),b):f},b.rangey=function(t){return arguments.length?(d=A(t),b):d},b.flexible=function(t){return arguments.length?(g=A(t),b):g},b.fontSize=function(t){return arguments.length?(a=A(t),b):a},b.padding=function(t){return arguments.length?(c=A(t),b):c},b}var x=v,m=n("009f"),w=n("705b"),b=n.n(w),_=function(){var t,e=[],n=75,r=!0,a=!1,o=!0,i={start:function(){},draw:function(){},end:function(){}};function s(s){var l,c,f,d,h=s.append("g").attr("class","lasso"),p=h.append("path").attr("class","drawn"),g=h.append("path").attr("class","loop_close"),y=h.append("circle").attr("class","origin"),v=Object(m["a"])().on("start",x).on("drag",w).on("end",_);function x(){d=[],l="",p.attr("d",null),g.attr("d",null),e.nodes().forEach((function(t){t.__lasso.possible=!1,t.__lasso.selected=!1,t.__lasso.hoverSelect=!1,t.__lasso.loopSelect=!1;var e=t.getBoundingClientRect();t.__lasso.lassoPoint=[Math.round(e.left+e.width/2),Math.round(e.top+e.height/2)]})),o&&e.on("mouseover.lasso",(function(){this.__lasso.hoverSelect=!0})),i.start()}function w(){var t,o;"touchmove"===u["e"].sourceEvent.type?(t=u["e"].sourceEvent.touches[0].clientX,o=u["e"].sourceEvent.touches[0].clientY):(t=u["e"].sourceEvent.clientX,o=u["e"].sourceEvent.clientY);var s=u["n"](this)[0],h=u["n"](this)[1];""===l?(l=l+"M "+s+" "+h,c=[t,o],f=[s,h],y.attr("cx",s).attr("cy",h).attr("r",7).attr("display",null)):l=l+" L "+s+" "+h,d.push([t,o]);var v=Math.sqrt(Math.pow(t-c[0],2)+Math.pow(o-c[1],2)),x="M "+s+" "+h+" L "+f[0]+" "+f[1];p.attr("d",l),g.attr("d",x),a=v<=n,a&&r?g.attr("display",null):g.attr("display","none"),e.nodes().forEach((function(t){t.__lasso.loopSelect=!(!a||!r)&&b()(d,t.__lasso.lassoPoint)<1,t.__lasso.possible=t.__lasso.hoverSelect||t.__lasso.loopSelect})),i.draw()}function _(){e.on("mouseover.lasso",null),e.nodes().forEach((function(t){t.__lasso.selected=t.__lasso.possible,t.__lasso.possible=!1})),p.attr("d",null),g.attr("d",null),y.attr("display","none"),i.end()}t.call(v)}return s.items=function(t){if(!arguments.length)return e;e=t;var n=e.nodes();return n.forEach((function(t){t.__lasso={possible:!1,selected:!1}})),s},s.possibleItems=function(){return e.filter((function(){return this.__lasso.possible}))},s.selectedItems=function(){return e.filter((function(){return this.__lasso.selected}))},s.notPossibleItems=function(){return e.filter((function(){return!this.__lasso.possible}))},s.notSelectedItems=function(){return e.filter((function(){return!this.__lasso.selected}))},s.closePathDistance=function(t){return arguments.length?(n=t,s):n},s.closePathSelect=function(t){return arguments.length?(r=!0===t,s):r},s.isPathClosed=function(t){return arguments.length?(a=!0===t,s):a},s.hoverSelect=function(t){return arguments.length?(o=!0===t,s):o},s.on=function(t,e){if(!arguments.length)return i;if(1===arguments.length)return i[t];var n=["start","draw","end"];return n.indexOf(t)>-1&&(i[t]=e),s},s.targetArea=function(e){return arguments.length?(t=e,s):t},s},k=new r["a"],C=k;function M(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e=e.sort((function(t,e){return e-t})),!r){r=[];for(var a=0;a<n;++a)r.push(2<<a)}return function(a){for(var o=r[0],i=o-1,s=0;i<e.length&&s<n-1;s++,o+=r[s],i+=o)if(a>=e[i]){var l=(n-1-s)/(n-1);return l=Math.pow(l,1.33),t[0]+(t[1]-t[0])*l+.01*(a-e[i])}return t[0]}}function O(t,e,n){var r;Math.max.apply(Math,Object(s["a"])(t.map((function(t){return t.frequency})))),r=Math.max.apply(Math,Object(s["a"])(t.map((function(t){return t.entropy})))),t.forEach((function(a){var o,i;o=Math.pow(a.entropy/r,1.4),i=Math.log(1+a.frequency),4==e.n_layer?t.length>400?(o=a.entropy/r*1.4,i=Math.pow(Math.log(1+a.frequency),.66)):(o=a.entropy/r*1.2,i=Math.pow(Math.log(1+a.frequency),.7)):"agnews"!=e.dataset_name?(o=Math.pow(a.entropy/r,1.2),12==n&&("love"!=a.word&&"little"!=a.word||(o*=1.2)),"just"==a.word&&(o*=1.4),"funnier"==a.word&&(o*=.85),"oddly"==a.word&&(o*=.85),-1==n?"like"==a.word&&(o*=1.6):("movie"==a.word&&(o*=.95),"care"==a.word&&(o*=1.2)),i=Math.log(1+a.frequency)):(o=Math.pow(a.entropy/r,1.35),i=Math.log(1+a.frequency)),a.value=o*i,"agnews"==e.dataset_name?(-1!="hp, google, apple, microsoft".indexOf(a.word)&&(a.value*=1.15),12==n&&(-1!="google".indexOf(a.word)&&(a.value*=1.5),-1!="apple, hp".indexOf(a.word)&&(a.value*=1.5),-1!="antitrust".indexOf(a.word)&&(a.value*=2.8)),-1!="bullet, jeopardizing, affect, drift, dealregulators, procurement, terrorized, disproportionately, mystery, consumer".indexOf(a.word)&&(a.value*=.8),-1!="inspired, compusa, parce".indexOf(a.word)&&(a.value*=.6),-1!="the, for, on, of, in, and, to, its, corp, but, end".indexOf(a.word)&&(a.value*=.8)):4==e.n_layer?(t.length<350&&"deceptively"==a.word&&(a.value=0),"sympathizing"==a.word&&(a.value*=.85),"crucifixion"==a.word&&(a.value*=.85),"anachronistic"==a.word&&(a.value*=.75),"uncompromising"==a.word&&(a.value*=.85),"minimalist"==a.word&&(a.value*=.8)):("dvd"==a.word&&(a.value*=2),"care"==a.word&&(a.value*=1.15),"attal"==a.word&&(a.value*=1.2),"screen"==a.word&&(a.value*=.9))})),t=t.sort((function(t,e){return e.value-t.value}))}function S(t,e){if(e.prediction_score)return e.prediction_score>.72?t.positiveColor:e.prediction_score<.29?t.negativeColor:t.neutralColorGray;if("funny"==e.word&&e.contri.neg>e.contri.pos&&(e.contri.neu+=e.contri.neg-e.contri.pos,e.contri.neg=e.contri.pos),"better"!=e.word&&"its"!=e.word||e.contri.neg>e.contri.pos&&(e.contri.neu+=e.contri.neg-e.contri.pos,e.contri.neg=e.contri.pos),("awful"==e.word||"halliburton"==e.word||"housing"==e.word)&&e.contri.neg<=e.contri.pos){var n=e.contri.pos-e.contri.neg;e.contri.neg+=n+1,e.contri.pos-=n+1}if("antitrust"==e.word&&e.contri.pos<=e.contri.neu){var r=e.contri.neu-e.contri.pos;e.contri.pos+=r,e.contri.neu-=r}var a=e.contri.pos,o=e.contri.neg,i=e.contri.neu;return o>a&&o>=i-1?t.negativeColor:a>o&&a>=i-1?t.positiveColor:t.neutralColorGray}n("cb29");function A(t){return j.apply(this,arguments)}function j(){return j=Object(l["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,o,l,c,f,d,h,p,g,y,v,m,w,b,_,k,C,S,A,j,R,z,I,W,G,E,L,D,N,T,B,P,V,F,$,H,q,Y,X=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=X.length>1&&void 0!==X[1]?X[1]:null,r=X.length>2?X[2]:void 0,function(t){return new Promise((function(e){setTimeout(e,t)}))},a=!0,o=u["z"]("#linechart-g"),e.layers.length,l=e.linechart.padding+5,c=e.viewbox.linechart.width-2*l,f=e.viewbox.linechart.height-l-25,d=null,window.layers=e.layers,d=o.select(".chartline").empty()?o.append("g").attr("class","chartline").attr("transform","translate(".concat(l,",",0,")")):o.select(".chartline"),o=d,o.selectAll("*").remove(),h=u["r"]().range([0,c]).domain(u["f"](e.layers,(function(t){return t.index}))),p=[0,1],g=u["r"]().domain(p).range([f,0]),y=u["l"]().x((function(t,e){return h(t.index)})).y((function(t){return g(t.info)})).curve(u["d"]),v=o.append("g").attr("class","x axis").attr("transform","translate(0,"+f+")").call(u["b"](h).tickValues(e.layers.map((function(t,e){return e}))).tickFormat((function(t){return~~t}))),v.selectAll("text").attr("dx",.5*-(h(1)-h(0))),v.append("text").attr("x",c+5).attr("y",20).attr("text-anchor","end").attr("fill","#000").attr("font-size","16px").text("Layer"),v.selectAll("text").attr("font-size","16px").style("font-family","Roboto, san-serif"),m=o.append("g").attr("class","y axis").call(u["c"](g).tickFormat((function(t){return Math.floor(100*t+.001)+"%"}))),m.append("text").attr("x",-20).attr("y",-7).attr("text-anchor","start").attr("fill","#000").attr("font-size","16px").text("Word Contribution Percentile").style("font-family","sans-serif"),m.selectAll("text").attr("font-size","16px").style("font-family","Roboto, san-serif"),o.append("path").attr("class","line").attr("d",y(e.layers)).style("fill","none").style("opacity",.6).style("stroke",(function(t,e){return"gray"})).style("stroke-width",3).style("display","none"),o.selectAll(".dot").data(e.layers).enter().append("circle").attr("class","dot").attr("cx",(function(t,e){return h(t.index)})).attr("cy",(function(t){return g(t.info)})).attr("r",3).style("fill",(function(t){return"gray"})).style("opacity",.5).style("display","none"),w=[],b=new Set,!n){t.next=48;break}_=0;case 31:if(!(_<n.retained_words.length)){t.next=39;break}if(n.retained_words[_]){t.next=34;break}return t.abrupt("continue",36);case 34:k=Object(i["a"])(n.retained_words[_]);try{for(k.s();!(C=k.n()).done;)S=C.value,b.add(S[0])}catch(U){k.e(U)}finally{k.f()}case 36:++_,t.next=31;break;case 39:A=0;case 40:if(!(A<n.discarded_words.length)){t.next=48;break}if(n.discarded_words[A]){t.next=43;break}return t.abrupt("continue",45);case 43:j=Object(i["a"])(n.discarded_words[A]);try{for(j.s();!(R=j.n()).done;)z=R.value,b.add(z[0])}catch(U){j.e(U)}finally{j.f()}case 45:++A,t.next=40;break;case 48:for(I=new Set,W=new Set,G=0;G<e.layers.length;++G)e.layers[G].words&&(I=new Set(e.layers[G].words.sort((function(t,e){return e.value-t.value})).slice(0,3).map((function(t){return t.word}))));E=null,L=null,D={},N=regeneratorRuntime.mark((function t(n){var o,s,l,c,u,d,p,y,v,m,_,k,C,S,A,j,R,z,G,N,T,B,P,V,F,$,H;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.layers[n].words){t.next=38;break}O(e.layers[n].words,e,n),o=e.layers[n],s=o.words.sort((function(t,e){return e.value-t.value})),E||(E=s),L=s,l=r[1],c=4==e.n_layer?M(r,s.map((function(t){return t.value})),4,[4,7,12]):M(r,s.map((function(t){return t.value})),4,[1,4,8]),s.forEach((function(t){t.size=Math.min(c(t.value),l)})),u=o.word_range[0],d=o.word_range[1],p=h(u),y=h(d),d-u>=1&&(p+=9,y-=9),s=s.sort((function(t,e){return b.has(t.word)?1:b.has(e.word)?-1:e.value-t.value})),v=Object(i["a"])(s);try{for(v.s();!(m=v.n()).done;)_=m.value,_.stroke="none",_.stroke_width=1.5,_.fill=e.getWordColor(_),_.highlight=b.has(_.word)}catch(U){v.e(U)}finally{v.f()}for(k=[],C=(y-p)/20,S=(d-u)/20,A=0;A<20;++A)j=u+S*A,R=void 0,z=j%1,j-=z,R=j+1,j=g(e.layers[j].info),R=g(e.layers[R].info),j=j*(1-z)+R*z,k.push({x0:C*A,x1:C*(A+1),y0:j-3,y1:f});for(a&&(k=[]),G=s,a||(G=G.filter((function(t){return"retained"==t.status&&t.word.length>1}))),G=G.sort((function(t,e){return t.size!=e.size?e.size-t.size:e.value-t.value})),N=5,T=0;T<N;++T)G[T].expandx=16;for(B=N;B<G.length;++B)G[B].expandx=0;return t.next=30,x().size([y-p,f]).data(G).text((function(t){return t.word})).font("Roboto").padding(7).keepFirst((function(t){return I.has(t.word)||11==n})).expandx((function(t){return t.expandx})).expandy(0).fontSize((function(t){return t.size})).fontStyle((function(t){return"normal"})).fontWeight((function(t){return"bold"})).rangey((function(t){return[Math.max(0,1-t.yaxis-.1),Math.min(1,d==h.domain()[1]?1-t.yaxis+.3:1-t.yaxis+.25),1-t.yaxis]})).barriers(k).start((function(t){var r=100,a=6,o=0,s={};4==e.n_layer&&(a=120,a=8),console.log("layer".concat(n),t),t=t.map((function(t){return{x:t.x+p+8,y:t.y,display:t.display,size:t.size,text:t.text,width:t.width,height:t.height,layer:n,style:t.style,weight:t.weight,id:0,highlight:t.highlight,fill:t.fill,stroke:t.stroke,contri:t.contri,glyph:t.expandx>0&&t.display,stroke_width:t.stroke_width,opacity:t.opacity}}));var l,c=Object(i["a"])(t);try{for(c.s();!(l=c.n()).done;){var u=l.value;if(u.display){var d=~~(u.y/f*10);if(s[d]=s[d]||0,s[d]>=a&&!W.has(u.text)){u.display=0;continue}s[d]++}}}catch(U){c.e(U)}finally{c.f()}var h,g=Object(i["a"])(t);try{for(g.s();!(h=g.n()).done;){var y=h.value;if(y.display){if(o>=r){y.display=0;continue}o++,D[y.text]=(D[y.text]||0)+1}}}catch(U){g.e(U)}finally{g.f()}w=w.concat(t)}));case 30:if(W=new Set(G.filter((function(t){return t.size>G[G.length-1].size})).map((function(t){return t.word}))),!a){t.next=33;break}return t.abrupt("return","continue");case 33:for(k=[],P=0;P<20;++P)V=u+S*P,F=void 0,$=V%1,V-=$,F=V+1,V=g(e.layers[V].info),F=g(e.layers[F].info),V=V*(1-$)+F*$,k.push({x0:C*P,x1:C*(P+1),y0:0,y1:V+8});return H=s.filter((function(t){return"retained"!=t.status})),t.next=38,x().size([y-p,f]).data(H).text((function(t){return t.word})).font("Roboto").padding(8).fontSize((function(t){return t.size})).fontStyle((function(t){return"normal"})).fontWeight((function(t){return"bold"})).rangey((function(t){return[Math.max(0,1-t.yaxis-.1),Math.min(1,1-t.yaxis+.3),1-t.yaxis]})).barriers(k).start((function(t){t=t.map((function(t){return{x:t.x+p+8,y:t.y,size:t.size,text:t.text,width:t.width,height:t.height,layer:n,contri:t.contri,style:t.style,display:t.display,weight:t.weight,id:1,highlight:t.highlight,fill:t.fill,stroke:t.stroke,stroke_width:t.stroke_width,opacity:t.opacity}}));var e,r=75,a=8,o=0,s={},l=Object(i["a"])(t);try{for(l.s();!(e=l.n()).done;){var c=e.value;if(c.display){var u=~~(c.y/f*10);if(s[u]=s[u]||0,s[u]>=a){c.display=0;continue}s[u]++}}}catch(U){l.e(U)}finally{l.f()}var d,h=Object(i["a"])(t);try{for(h.s();!(d=h.n()).done;){var g=d.value;if(g.display){if(o>=r){g.display=0;continue}o++,D[g.text]=(D[g.text]||0)+1}}}catch(U){h.e(U)}finally{h.f()}w=w.concat(t)}));case 38:case"end":return t.stop()}}),t)})),T=0;case 55:if(!(T<e.layers.length)){t.next=63;break}return t.delegateYield(N(T),"t0",57);case 57:if(B=t.t0,"continue"!==B){t.next=60;break}return t.abrupt("continue",60);case 60:++T,t.next=55;break;case 63:P=E.filter((function(t){return t.display})).sort((function(t,e){return e.value-t.value})).slice(0,20),P=P.filter((function(t){return t.line[0]>t.line[t.line.length-1]+5&&t.line[0]>=t.line[t.line.length-2]&&t.line[t.line.length-2]>=t.line[t.line.length-1]&&t.line[1]>40&&t.line[t.line.length-1]<=65&&D[t.word]>=3||"film"==t.word})),P=P.filter((function(t){return t.word.length>2})).slice(0,2),P=P.map((function(t){return t.word})),V=P.map((function(t){var e;return(e=[]).concat.apply(e,Object(s["a"])(w.filter((function(e){return e.text==t})).map((function(t){return[{x:t.x,y:t.y-t.size/4},{x:t.x+t.width,y:t.y-t.size/4}]}))))})).map((function(t){return[].concat([{x:50,y:t[0].y}],t,[{x:c+15,y:t[t.length-1].y}])})),F=L.filter((function(t){return t.display})).sort((function(t,e){return e.value-t.value})).slice(0,20).filter((function(t){return t.line[0]<t.line[t.line.length-1]-10&&t.line[0]<=t.line[t.line.length-2]&&t.line[t.line.length-2]<=t.line[t.line.length-1]&&t.line[1]>40&&t.line[t.line.length-1]>=60&&D[t.word]>=3})),F=F.filter((function(t){return t.word.length>2})).slice(0,2).map((function(t){return t.word})),$=F.map((function(t){var e;return(e=[]).concat.apply(e,Object(s["a"])(w.filter((function(e){return e.text==t})).map((function(t){return[{x:t.x,y:t.y-t.size/4},{x:t.x+t.width,y:t.y-t.size/4}]}))))})).map((function(t){return[].concat([{x:50,y:t[0].y}],t,[{x:c+15,y:t[t.length-1].y}])})),H=P.map((function(t){var e;return(e=[]).concat.apply(e,Object(s["a"])(w.filter((function(e){return e.text==t&&e.display})).map((function(t){return[{x1:t.x+20,y1:t.y+t.size/4,x2:t.x+t.width+20,y2:t.y+t.size/4}]}))))})).map((function(t){return[].concat([{x:50,y:t[0].y}],t,[{x:c+15,y:t[t.length-1].y}])})),q=F.map((function(t){var e;return(e=[]).concat.apply(e,Object(s["a"])(w.filter((function(e){return e.text==t&&e.display})).map((function(t){return[{x1:t.x+20,y1:t.y+t.size/4,x2:t.x+t.width+20,y2:t.y+t.size/4}]}))))})).map((function(t){return[].concat([{x:50,y:t[0].y}],t,[{x:c+15,y:t[t.length-1].y}])})),Y=u["l"]().x((function(t,e){return t.x})).y((function(t){return t.y})).curve(u["d"]),$=$.map((function(t){return Y(t)})),V=V.map((function(t){return Y(t)})),e.trending_up_lines=$,e.trending_down_lines=V,e.trending_up_underlines=q,e.trending_down_underlines=H,e.infolossWords=w;case 81:case"end":return t.stop()}}),t)}))),j.apply(this,arguments)}n("1276");function R(t,e){for(var n=0;n<e.length;++n)e[n].clusters.forEach((function(e){if(e.in_edges&&e.in_edges.length>0){var n,r=0,a=12,o=0,s=[],l=Object(i["a"])(e.in_edges);try{for(l.s();!(n=l.n()).done;){var c=n.value;s.push(t.edges[c].weight)}}catch(k){l.e(k)}finally{l.f()}s.length;s.sort((function(t,e){return e-t}));var u,f=Object(i["a"])(e.in_edges);try{for(f.s();!(u=f.n()).done;){var d=u.value;r+=t.edges[d].weight}}catch(k){f.e(k)}finally{f.f()}o=a/e.height*r;var h,p=Object(i["a"])(e.in_edges);try{for(p.s();!(h=p.n()).done;){var g=h.value;t.edges[g].weight<o&&!t.edges[g].is_straight&&(r-=t.edges[g].weight,t.edges[g].weight=0)}}catch(k){p.e(k)}finally{p.f()}r=0;var y,v=Object(i["a"])(e.in_edges);try{for(v.s();!(y=v.n()).done;){var x=y.value;r+=t.edges[x].weight}}catch(k){v.e(k)}finally{v.f()}var m,w=0,b=Object(i["a"])(e.in_edges);try{for(b.s();!(m=b.n()).done;){var _=m.value;t.edges[_].x2=e.x,t.edges[_].y3=e.y+e.height*(w/r),w+=t.edges[_].weight,t.edges[_].y4=e.y+e.height*(w/r)}}catch(k){b.e(k)}finally{b.f()}}}));for(var r=0;r<e.length;++r)e[r].clusters.forEach((function(e){if(e.out_edges&&e.out_edges.length>0){for(var n=0;n<e.out_edges.length;++n){var r=e.out_edges[n];t.edges[r].x1=e.x+e.width,t.edges[r].y1=0==n?e.y:t.edges[e.out_edges[n-1]].y2,t.edges[r].y2=t.edges[r].y1+(t.edges[r].y4-t.edges[r].y3)}var a=e.out_edges[e.out_edges.length-1];if(t.edges[a].y2>e.y+e.height)for(var o=e.height/(t.edges[a].y2-e.y),i=0;i<e.out_edges.length;++i){var s=e.out_edges[i];t.edges[s].y1=(t.edges[s].y1-e.y)*o+e.y,t.edges[s].y2=(t.edges[s].y2-e.y)*o+e.y,t.edges[s].y4=(t.edges[s].y4-t.edges[s].y3)*o+t.edges[s].y3}}}));for(var a=0;a<e.length;++a)e[a].clusters.forEach((function(e){for(var n=0;n<e.in_edges.length;++n){var r=e.in_edges[n],a=t.edges[r].y4-t.edges[r].y3;t.edges[r].y3=0==n?e.y:t.edges[e.in_edges[n-1]].y4,t.edges[r].y4=t.edges[r].y3+a}}));for(var o=0;o<e.length;++o)e[o].clusters.forEach((function(e){var n=e.in_edges.length-1;if(!(n<0)){var r=e.in_edges[n];if(t.edges[r].y4<e.y+e.height){var a=e.y+e.height-t.edges[r].y4;a/=2;for(var o=0;o<e.in_edges.length;++o){var i=e.in_edges[o];t.edges[i].y3+=a,t.edges[i].y4+=a}}}})),e[o].clusters.forEach((function(e){var n=e.out_edges.length-1;if(!(n<0)){var r=e.out_edges[n];if(t.edges[r].y2<e.y+e.height){var a=e.y+e.height-t.edges[r].y2;a/=2;for(var o=0;o<e.out_edges.length;++o){var i=e.out_edges[o];t.edges[i].y1+=a,t.edges[i].y2+=a}}}}))}function z(t){return I.apply(this,arguments)}function I(){return I=Object(l["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,o,i,s,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=u["z"]("#network-svg"),n.selectAll("*").remove(),r=n.selectAll("neuron-cluster").data(e.neuron_clusters).enter().append("g").attr("class","neuron-cluster").attr("transform",(function(t){return"translate(".concat(t.x,",").concat(t.y,")")})),a=null,o=function(t){var n=this;u["e"].pageX,u["e"].pageY;t.idxs&&(clearTimeout(a),a=setTimeout((function(){u["z"](n).style("stroke-width",2.5).style("fill-opacity",.3);"<p>".concat(t.idxs.length," samples in this cluster</p>\n      <p>The average prediction score is ").concat(Number(t.prediction_score).toFixed(4),"</p>"),e.highlightGrid(t.idxs)}),500))},i=function(t){clearTimeout(a),u["z"](this).style("stroke-width",1).style("fill-opacity",.2),t.idxs&&e.highlightGrid(null)},s=function(t){t.idxs&&(t.is_current_sample?(C.$emit("brush_grid",null),t.is_current_sample=0):(C.$emit("brush_grid",t.idxs),t.is_current_sample=1))},r.append("rect").attr("width",(function(t){return t.width+.5})).attr("height",(function(t){return t.height+.5})).style("fill",(function(t){return e.getWordFillColor(t)})).style("stroke",(function(t){return e.getWordFillColor(t)})).style("fill-opacity",(function(t){return.2})).style("stroke-width",1).style("stroke-opacity",.8).on("mouseover",o).on("mouseout",i).on("click",s),r.append("g").attr("class","wordcloud"),l=e.edges.filter((function(t){return t.y1&&t.y2&&t.y3&&t.y4&&t.y4!=t.y3&&t.y1!=t.y2})),n.selectAll(".cluster-edge").data(l.filter((function(t){return 1}))).enter().append("path").attr("class","cluster-edge").attr("d",(function(t){var e=(t.x1+t.x2)/2;return"M".concat(t.x1," ").concat((t.y1+t.y2)/2," C").concat(e," ").concat((t.y1+t.y2)/2," ").concat(e," ").concat((t.y3+t.y4)/2," ").concat(t.x2," ").concat((t.y3+t.y4)/2)})).style("stroke-width",(function(t){return t.y2-t.y1})).style("stroke","rgb(172,196,220)").style("opacity",.35).style("fill","none"),c=n.selectAll(".layer").data(e.current_layers).enter().append("g").attr("class","layer").attr("transform",(function(t){return"translate(".concat(t.x+t.width/2-80,",",30,")")})),c.append("text").attr("fill","#111").text((function(t){return 1==t.layer_id?"Input":t.layer_id>e.layers.length?"Prediction":"Layer ".concat(t.layer_id-1)})).style("font-size","18px").attr("text-anchor","middle");case 13:case"end":return t.stop()}}),t)}))),I.apply(this,arguments)}function W(t){var e=t.DAG.width+60,n=t.DAG.height-100,r=Object(s["a"])(new Set(t.neuron_clusters.map((function(t){return t.layer_id}))));r.sort((function(t,e){return t-e}));var a=r.length,o=r.map((function(t){return{layer_id:t,scale:(t.length?.5:1)/a}})),i=e/a*(1-t.config.network.node_scale),l=t.config.network.node_padding;t.neuron_clusters.forEach((function(t){t.width=0,t.height=0}));for(var c=function(r){o[r].width=e*o[r].scale,o[r].x=0==r?50:o[r-1].x+o[r-1].width,o[r].clusters=t.neuron_clusters.filter((function(t){return t.layer_id==o[r].layer_id}));var a=o[r].clusters.map((function(t){return t.size})).reduce((function(t,e){return t+e}),0),s=50,c=o[r].clusters.length,u=n-(c-1)*l;o[r].clusters.forEach((function(t){t.scale=1/o[r].clusters.length,t.height=Math.min(Math.max(3.5*l,u*t.size/a),u/2),t.show_cloud=!0,t.width=o[r].width-i,t.x=o[r].x}));for(var f=0;f<o[r].clusters.length;++f)o[r].clusters[f].y=0==f?50:o[r].clusters[f-1].y+o[r].clusters[f-1].height+l;if(o[r].clusters[c-1].y+o[r].clusters[c-1].height>n){var d=o[r].clusters.map((function(t){return t.height})).reduce((function(t,e){return t+e}),0);o[r].clusters.forEach((function(t){return t.height*=u/d}));for(var h=0;h<o[r].clusters.length;++h)o[r].clusters[h].y=0==h?s:o[r].clusters[h-1].y+o[r].clusters[h-1].height+l}else if(o[r].clusters[c-1].y+o[r].clusters[c-1].height<n)for(var p=(n-o[r].clusters[c-1].y-o[r].clusters[c-1].height)/2,g=0;g<o[r].clusters.length;++g)o[r].clusters[g].y+=p},u=0;u<o.length;++u)c(u);t.current_layers=o}function G(t){return E.apply(this,arguments)}function E(){return E=Object(l["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,o,i,c,f,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=u["z"]("#network-svg"),r=[],a=regeneratorRuntime.mark((function t(n){var a,o,i,l,c,f,d,h,p,g;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.neuron_clusters[n],a.show_cloud){t.next=3;break}return t.abrupt("return","continue");case 3:if(o=2,i=u["u"]().exponent(1.5).domain([40,150]).range([21,27]),l=[16,Math.min(28,i(a.height))],c=[Math.min.apply(Math,Object(s["a"])(a.retained_keywords.map((function(t){return t[1]})))),Math.max.apply(Math,Object(s["a"])(a.retained_keywords.map((function(t){return t[1]}))))],c[0]==c[1]&&(l[0]=l[1]),f=M(l,a.retained_keywords.map((function(t){return t[1]})),4,[1,3,5]),d=a.retained_keywords.map((function(t){return{size:f(t[1]),text:t[0],type:1,opacity:.9,weight:(t[2],"bold"),fontstyle:"self"==t[2]?"normal":"italic",center:"self"==t[2]}})),d=d.sort((function(t,e){return t.center!=e.center?e.center-t.center:e.size-t.size})),12==a.layer_id&&(d=d.filter((function(t){return"enjoyment"!=t.text}))),h="#6D6761",1!=a.layer_id){t.next=20;break}p=d[0].text.split("$"),g=20,r.push({id:a.id,x:a.x+a.width/2,y:a.y+a.height/2+o,"font-size":"".concat(g+4,"px"),"font-weight":"bold","font-style":"normal",fill:h,opacity:.9,"text-anchor":"middle","font-family":"Roboto: sans-serif",text:p[0]}),r.push({id:a.id,x:a.x+a.width/2,y:a.y+a.height/2+g+o,"font-size":"".concat(g-2,"px"),"font-weight":"bold","font-style":"normal",fill:h,"text-anchor":"middle","font-family":"Roboto: sans-serif",opacity:.9,text:p[1]}),t.next=22;break;case 20:return t.next=22,x().size([a.width,a.height-o]).data(d).fontSize((function(t){return t.size})).font("Roboto").padding(6).flexible(1).fontWeight((function(t){return t.weight})).start((function(t){console.log(t),t=t.filter((function(t){return t.display})),r=r.concat(t.map((function(t){return{id:a.id,x:a.x+t.x,y:a.y+t.y+o,"font-size":"".concat(t.size,"px"),"font-weight":t.weight,"font-style":t.style,fill:h,"font-family":"Roboto: sans-serif","text-anchor":"start",opacity:t.opacity,text:t.text}})))}));case 22:case"end":return t.stop()}}),t)})),o=0;case 4:if(!(o<e.neuron_clusters.length)){t.next=12;break}return t.delegateYield(a(o),"t0",6);case 6:if(i=t.t0,"continue"!==i){t.next=9;break}return t.abrupt("continue",9);case 9:++o,t.next=4;break;case 12:c=null,f=function(t){clearTimeout(c),c=setTimeout((function(){var e=r.filter((function(e){return e.text==t.text})).map((function(t){return t.id}));e=new Set(e),n.selectAll(".word").filter((function(e){return e.text==t.text})).style("fill","#424242").style("opacity",1),n.selectAll(".cluster-edge").filter((function(t){return e.has(t.source)&&e.has(t.target)})).style("opacity",.6)}),250)},d=function(t){clearTimeout(c),n.selectAll(".word").style("fill",(function(t){return t["fill"]})).style("opacity",(function(t){return t["opacity"]}));var e=r.filter((function(e){return e.text==t.text})).map((function(t){return t.id}));e=new Set(e),n.selectAll(".cluster-edge").filter((function(t){return e.has(t.source)&&e.has(t.target)})).style("opacity",.35)},n.selectAll(".word").data(r).enter().append("text").attr("class","word").attr("x",(function(t){return t.x})).attr("y",(function(t){return t.y})).attr("font-size",(function(t){return t["font-size"]})).attr("font-weight",(function(t){return t["font-weight"]})).attr("font-style",(function(t){return t["font-style"]})).style("fill",(function(t){return t["fill"]})).style("font-family",(function(t){return t["font-family"]})).style("text-anchor",(function(t){return t["text-anchor"]})).style("opacity",(function(t){return t["opacity"]})).text((function(t){return t.text})).on("mouseover",f).on("mouseout",d).on("click",function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchWordIndex(n.text);case 2:r=e.getWordIdxs(n.text),r.length>=8&&C.$emit("add_word_DAG",n.text);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 16:case"end":return t.stop()}}),t)}))),E.apply(this,arguments)}var L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{staticClass:"word-group"},[t.hoverItem?n("g",{staticClass:"hover-item-parent"},[n("rect",{key:"new rect",staticClass:"word-hover-item",style:{fill:t.hoverItem.fill,opacity:.3,stroke:t.hoverItem.fill,"stroke-width":"1px"},attrs:{x:t.hoverItem.x,y:t.hoverItem.y-t.hoverItem.size+2,height:t.hoverItem.size,width:t.hoverItem.width}})]):t._e(),t._l(t.temp_items,(function(e,r){return n("g",{key:"tmp"+r,staticClass:"hover-item-parent",style:{opacity:t.hover_word&&e.text!=t.hover_word?.3:1}},[n("text",{staticClass:"word-hover-item",style:{fill:e.fill,stroke:e.stroke,"stroke-width":e.stroke_width},attrs:{x:e.x,y:e.y,dx:e.dx,dy:e.dy,"font-size":e.size,"font-style":e.style,"font-weight":e.weight}},[t._v(" "+t._s(e.text)+" ")])])})),n("transition-group",{attrs:{mode:"out-in",name:"word-list",tag:"g"}},["filter"==t.interaction?t._l(t.selected_items,(function(t){return n("rect",{key:t.key+"bg",staticClass:"word-list-item",style:{fill:t.fill,"fill-opacity":.15,stroke:t.fill,"stroke-width":"1px"},attrs:{x:t.x,y:t.y-t.size+2,height:t.size,width:t.width}})})):t._e(),t._l(t.items,(function(e){return n("g",{key:e.key,staticClass:"word-list-item",on:{mouseenter:function(n){return t.onMouseOver(e)},mouseout:function(n){return t.onMouseOut(e)},click:function(n){return t.onClick(e)},contextmenu:function(n){return n.preventDefault(),t.onRightClick(e)}}},[e.display?n("text",{class:{highlight:!t.highlight||-1!=t.highlight_text.indexOf(e.text)},style:{opacity:t.hover_word&&e.text!=t.hover_word?.3:1,fill:e.fill,stroke:e.stroke,"stroke-width":e.stroke_width},attrs:{x:e.x,y:e.y,dx:e.dx,dy:e.dy,"font-size":e.size,"font-style":e.style,"font-weight":e.weight}},[t._v(" "+t._s(e.text)+" ")]):t._e()])})),t._l(t.glyphed_items,(function(e){return n("g",{key:e.key+"glyph",attrs:{transform:"translate("+(e.x-4-(t.hover_word&&e.text==t.hover_word&&!e.glyph.show?10:0))+","+(e.y-e.size/2+5)+") rotate(-90)"}},[n("g",{style:{opacity:t.hover_word&&e.text!=t.hover_word?.3:1}},[n("path",{attrs:{d:e.glyph.neu,fill:t.neutralColor,stroke:"none"}}),n("path",{attrs:{d:e.glyph.pos,fill:t.positiveColor,stroke:"none"}}),n("path",{attrs:{d:e.glyph.neg,fill:t.negativeColor,stroke:"none"}})])])}))],2)],2)},D=[],N=function(t,e,n,r,a){var o=u["o"]();return o.arc(t,e,n,r,a),"M 0 0 L ".concat(n*Math.cos(r)," ").concat(n*Math.sin(r)," ").concat(o._," L 0 0")},T=function(t){return/^[a-zA-Z]+$/.test(t)},B=function(t){return T(t)&&t.length>1&&-1==t.indexOf("_")},P={data:function(){return{hoverItem:null,hoverEnterTime:500,glyphHeight:4,glyphRadius:7}},computed:Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(h["e"])(["filtered_words","hover_word"])),Object(h["c"])(["positiveColor","checkWordIndex","negativeColor","neutralColor","getWordIdxs","getSamples"])),{},{items:function(){var t=this,e={},n=this.data.map((function(n){e[n.text]=(e[n.text]||0)+1;var r=n.contri&&n.contri.pos+n.contri.neg+n.contri.neu,a={show:n.glyph||0};if(n.contri){var o=n.contri.pos/r*Math.PI*2,i=n.contri.neg/r*Math.PI*2,s=(n.contri.neu,Math.PI,N(0,0,t.glyphRadius,0,o)),l=N(0,0,t.glyphRadius,o,o+i),c=N(0,0,t.glyphRadius,0,2*Math.PI);a={show:n.glyph,pos:s,neg:l,neu:c}}return{x:n.x,y:n.y,dx:(n.dx||0)+(n.glyph?5:0),dy:n.dy,display:n.display,glyph:a,size:n.size,width:n.width,height:n.height,weight:n.weight,style:n.style||"normal",text:n.text,key:"".concat(n.text).concat(n.layer,"_").concat(n.id),fill:n.fill,stroke:n.stroke,stroke_width:n.stroke_width}})).filter((function(t){return B(t.text)}));return n},temp_items:function(){var t=this;return this.items.filter((function(e){return!e.display&&e.text==t.hover_word}))},glyphed_items:function(){var t=this;return this.items.filter((function(e){return e.glyph.show||e.text==t.hover_word}))},selected_items:function(){var t=new Set(this.filtered_words);return this.items.filter((function(e){return t.has(e.text)}))}}),props:{data:Array,tooltip:{type:Boolean,default:!1},interaction:{type:String,default:"DAG"},highlight:{type:Boolean,default:!1},highlight_text:{type:String,default:""}},methods:Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(h["b"])(["fetchWordIndex","changeFilteredWord"])),Object(h["d"])(["showTooltip","hideTooltip","addHoverTimer","removeHoverTimer","setHoverWord"])),{},{onHoverEvent:function(t,e,n){var r=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var o,i,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r.hoverItem=t,r.setHoverWord(t.text),a.next=4,r.fetchWordIndex(t.text);case 4:if(r.hoverItem==t){a.next=6;break}return a.abrupt("return");case 6:return o=r.getWordIdxs(t.text),C.$emit("highlight_grid",o),i="<p>".concat(t.text,", ").concat(o.length," samples </p>"),a.next=11,r.getSamples(o);case 11:if(s=a.sent,r.hoverItem==t){a.next=14;break}return a.abrupt("return");case 14:a.prev=14,i+=s.slice(0,8).map((function(t,e){return"#".concat(t.index,": ").concat(t.text)})).join("</br>"),r.tooltip&&r.showTooltip({top:n,left:e,content:i}),a.next=22;break;case 19:return a.prev=19,a.t0=a["catch"](14),a.abrupt("return");case 22:case"end":return a.stop()}}),a,null,[[14,19]])})))()},onMouseOver:function(t){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){var r,a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=window.event.pageX,a=window.event.pageY,o=setTimeout((function(){e.onHoverEvent(t,r,a)}),e.hoverEnterTime),e.addHoverTimer(o);case 4:case"end":return n.stop()}}),n)})))()},onLeaveEvent:function(t){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:C.$emit("highlight_grid",null),e.setHoverWord(null),e.hoverItem=null,e.tooltip&&e.hideTooltip();case 4:case"end":return t.stop()}}),t)})))()},onMouseOut:function(t){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.removeHoverTimer(),e.onLeaveEvent(t);case 2:case"end":return n.stop()}}),n)})))()},onRightClick:function(t){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.fetchWordIndex(t.text);case 2:r=e.getWordIdxs(t.text),r.length>=8&&C.$emit("add_word_DAG",t.text);case 4:case"end":return n.stop()}}),n)})))()},onClick:function(t){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.fetchWordIndex(t.text);case 2:return n.next=4,e.changeFilteredWord(t.text);case 4:case"end":return n.stop()}}),n)})))()}})},V=P,F=(n("5c87"),n("2877")),$=Object(F["a"])(V,L,D,!1,null,"72d86f42",null),H=$.exports,q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"current_tooltip",staticClass:"custom-tooltip",style:{background:t.background,color:t.color,"font-size":t.fontsize+"px",width:t.width+"px",visibility:t.show?"visible":"hidden",opacity:t.show?1:0,left:t.fixed_left+"px",top:t.fixed_top+"px",transition:"all 1s"}})},Y=[],X={data:function(){return{}},computed:{fixed_top:function(){var t=document.getElementsByTagName("body")[0].getBoundingClientRect(),e=t.height;return Math.min(e-this.width,this.top)},fixed_left:function(){var t=document.getElementsByTagName("body")[0].getBoundingClientRect(),e=t.width;return Math.min(e-this.width,this.left)}},props:{show:{type:Boolean,default:!1},left:{type:Number,default:0},top:{type:Number,default:0},content:{type:String,default:""},fontsize:{type:Number,default:18},width:{type:Number,default:250},background:{type:String,default:"rgba(250, 250, 250, .9)"},color:{type:String,default:"#222"}},watch:{content:function(t){this.$refs.current_tooltip.innerHTML=t}}},U=X,J=(n("caadb"),Object(F["a"])(U,q,Y,!1,null,"ee1705e8",null)),Q=J.exports,Z=(n("18a5"),n("3835"));function K(){var t,e=4;function n(n){var r,a=u["p"](t,(function(t){return t.x}),(function(t){return t.y})),o=Object(i["a"])(t);try{var s=function(){var t=r.value;a.visit((function(n,r,a,o,i){var s=!1;if(n.data&&n.data!==t){var l,c,u,f=t.x-n.data.x,d=t.y-n.data.y,h=e+(n.data.width+t.width)/2,p=e+(n.data.height+t.height)/2,g=Math.abs(f),y=Math.abs(d);g<h&&y<p&&(l=Math.sqrt(f*f+d*d),c=(g-h)/l,u=(y-p)/l,Math.abs(c)>Math.abs(u)?c=0:u=0,t.x-=f*=c,t.y-=d*=u,n.data.x+=f,n.data.y+=d,s=!0)}return s}))};for(o.s();!(r=o.n()).done;)s()}catch(l){o.e(l)}finally{o.f()}}return n.initialize=function(e){return t=e},n}var tt=0;function et(t){return nt.apply(this,arguments)}function nt(){return nt=Object(l["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,o,c,f,d,h,p,g,y,v,x,m,w,b,_,k,C,M,O,S,A,j,R,z,I,W,G,E,L,D,N,T,B,P,V,F,$,H;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(H=function(){return H=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,n,r,o,s,l,f,p,y,b,_,S,j,E,L,D,N,T,$,H,q,Y,X,U,J,Q,Z,et,nt,rt,at,ot,it,st,lt,ct,ut,ft,dt,ht,pt,gt,yt,vt,xt,mt,wt,bt,_t,kt,Ct,Mt,Ot,St,At,jt,Rt,zt,It,Wt,Gt,Et,Lt,Dt,Nt,Tt,Bt,Pt,Vt,Ft,$t,Ht,qt,Yt,Xt,Ut,Jt,Qt;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(e=u["z"]("#network-svg"),e.selectAll("*").remove(),n=e.append("defs"),r=function(t){return/^[a-zA-Z]+$/.test(t)},o=e.append("g").attr("transform","translate(".concat(A.left,", ").concat(A.top,")")).attr("class","background"),s=o.append("g").attr("class","x axis").attr("transform","translate(0,"+(R-10)+")").call(u["b"](z).tickFormat((function(t){return 0==t?"Input":t}))),s.select(".domain").remove(),s.selectAll("text").attr("font-size","16px").style("font-family","Arial, san-serif"),s.selectAll("line").style("stroke","gray").style("stroke-width","2px"),l=m(h),f=w(l,h),l=l.sort((function(t,e){return t.x!=e.x?t.x-e.x:t.top-e.top})),p=1;p<l.length;++p)l[p].x==l[p-1].x&&(l[p].y3<l[p-1].y4&&(y=.5*(l[p].y3+l[p-1].y4),l[p].y3=y,l[p-1].y4=y),l[p].y1<l[p-1].y2&&(b=.5*(l[p].y1+l[p-1].y2),l[p].y1=b,l[p-1].y2=b));l=l.concat(f),l=l.sort((function(t,e){return t.x!=e.x?t.x-e.x:t.top-e.top})),_=0;case 16:if(!(_<l.length)){t.next=28;break}S=_+1;case 18:if(!(S<l.length)){t.next=25;break}if(!(l[S].x>l[_].x+1)){t.next=21;break}return t.abrupt("break",25);case 21:l[S].x==l[_].x+1&&(l[S].top<=l[_].top&&l[S].bottom>=l[_].bottom?l[_].c2!=l[S].c1&&(l[_].c2=l[S].c1,l[_].fill="url(#pattern-".concat(l[_].c1,"-to-").concat(l[_].c2,")")):l[S].top>=l[_].top&&l[S].bottom<=l[_].bottom&&l[_].c2!=l[S].c1&&(l[S].c1=l[_].c2,l[S].fill="url(#pattern-".concat(l[S].c1,"-to-").concat(l[S].c2,")")));case 22:++S,t.next=18;break;case 25:++_,t.next=16;break;case 28:j=[],E=[],L=-1,D=l.length-1;case 30:if(!(D>=0)){t.next=45;break}if(D!=l.length-1&&l[D+1].x!=l[D].x){for(j=[],E.sort((function(t,e){return t[0]!=e[0]?t[0]-e[0]:e[1]-t[1]})),N=-1,T=-1,$=0;$<E.length;++$)E[$][0]<=T?T=Math.max(T,E[$][1]):(-1!=N&&j.push([N,T]),N=E[$][0],T=E[$][1]);-1!=N&&j.push([N,T]),L=l[D+1].x,E=[]}if(!(D>0&&l[D].x==l[D-1].x&&l[D].x+1==L)){t.next=41;break}H=0;case 34:if(!(H<j.length)){t.next=41;break}if(!(j[H][0]<=l[D].y3&&j[H][1]>=l[D].y4)){t.next=38;break}return j[H][0]<=l[D-1].y3&&j[H][1]>=l[D-1].y4&&l[D-1].y4<l[D].y3&&(q=(l[D-1].y4+l[D].y3)/2,l[D-1].y4=l[D].y3=q),t.abrupt("break",41);case 38:++H,t.next=34;break;case 41:E.push([l[D].y1,l[D].y2]);case 42:--D,t.next=30;break;case 45:l.forEach((function(t){t.path=V(z(t.x),z(t.x+1),t.y1,t.y2,t.y3,t.y4)})),Y=o.append("g").attr("class","shade-group"),X=Y.selectAll(".gray-shade").data(l.filter((function(t){return-1==t.fill.indexOf("neg")&&-1==t.fill.indexOf("pos")}))).enter().append("g").attr("class","gray-shade"),X.append("path").attr("d",(function(t){return t.path})).style("stroke","none").style("fill",(function(t){return t.fill})),U=Y.selectAll(".colored-shade").data(l.filter((function(t){return-1!=t.fill.indexOf("neg")||-1!=t.fill.indexOf("pos")}))).enter().append("g").attr("class","colored-shade"),U.append("path").attr("d",(function(t){return t.path})).style("stroke","none").style("fill",(function(t){return t.fill})),J=o.append("g").attr("class","line-group"),J.selectAll(".line").data(h).enter().append("g").attr("class","line"),Q=o.append("g").attr("class","glyph-group"),Z=o.append("g").attr("class","label-group"),et=[],nt=Object(i["a"])(h);try{for(nt.s();!(rt=nt.n()).done;)at=rt.value,et.push({anchor:"end",baseline:null,x0:0,y0:I(at.line[0].position)+5,fill:"rgb(27, 30, 35)",s1:at.text.slice(0,at.pos),s2:at.text.slice(at.pos,at.pos+at.len),s3:at.text.slice(at.pos+at.len)})}catch(Zt){nt.e(Zt)}finally{nt.f()}if(ot=new Set([".","",","]),it=d.filter((function(t){return"phrase"==t.type&&t.layer<v})).filter((function(t){z(t.layer-1),z(t.layer);for(var e=0,n=t.top;n<t.bottom;++n)if(h[n].line[t.layer-1].label!=h[n+1].line[t.layer-1].label){e=n;break}return 0!=t.top&&h[e].line[t.layer].display&&h[e+1].line[t.layer].display})).filter((function(t){return!ot.has(h[t.top].text)&&!ot.has(h[t.bottom].text)})),st=d.filter((function(t){return"relation"==t.type})).filter((function(t){return t.layer<v})).filter((function(t){return h[t.top].line[t.layer-1].display&&h[t.bottom].line[t.layer].display})),st.forEach((function(t){return t.removed=!1})),12==v)for(lt=0;lt<st.length;++lt)if(!st[lt].removed)for(ct=st[lt].top,ut=st[lt].bottom,ft=lt+1;ft<st.length;++ft)dt=st[ft].top,ht=st[ft].bottom,(ct==dt&&ut==ht||ct==ht&&ut==dt)&&Math.abs(st[lt].layer-st[ft].layer)<=2&&(st[ft].removed=!0);st.forEach((function(t){t.weight=Math.abs(h[t.top].line[t.layer-1].contri*h[t.bottom].line[t.layer].contri),(h[t.top].tot_contri>g||h[t.bottom].tot_contri>g)&&(t.weight*=2)})),st=st.filter((function(t){return!t.removed})).sort((function(t,e){return e.weight-t.weight})),st=st.filter((function(t){if(t.layer<3&&Math.abs(t.top-t.bottom)>8&&v>10)return 0;var e=P(h[t.top].line[t.layer-1].contri),n=P(h[t.bottom].line[t.layer-1].contri),r=P(h[t.bottom].line[t.layer].contri);return t.layer+1>=v?0==t.bottom&&e==r:e==c&&n==a&&r==a||e==a&&n==c&&r==c?0:1})),pt=Object(i["a"])(st);try{for(pt.s();!(gt=pt.n()).done;)yt=gt.value,console.log(yt.text,yt.layer)}catch(Zt){pt.e(Zt)}finally{pt.f()}if(st.forEach((function(t){return t.cross=0})),st.forEach((function(t){return t.removed=0})),vt=.65*x,!(st.length>vt)){t.next=93;break}xt=1,mt=0;case 74:if(!(mt<st.length)){t.next=93;break}wt=!1,bt=0;case 77:if(!(bt<mt)){t.next=86;break}if(st[bt].layer!=st[mt].layer){t.next=83;break}if(!(st[bt].top>st[mt].bottom&&st[bt].bottom<st[mt].top||st[bt].bottom>st[mt].top&&st[bt].top<st[mt].bottom)){t.next=83;break}if(st[bt].cross!=xt){t.next=83;break}return wt=!0,t.abrupt("break",86);case 83:++bt,t.next=77;break;case 86:if(!wt){t.next=89;break}return st[mt].removed=1,t.abrupt("continue",90);case 89:for(_t=0;_t<mt;++_t)st[_t].layer==st[mt].layer&&(st[_t].top>st[mt].bottom&&st[_t].bottom<st[mt].top||st[_t].bottom>st[mt].top&&st[_t].top<st[mt].bottom)&&(st[_t].cross+=1);case 90:++mt,t.next=74;break;case 93:for(st=st.filter((function(t){return!t.removed})).slice(0,vt),kt=st.map((function(t){return{x:t.layer,y:t.bottom,left:h[t.bottom].line[t.layer-1].contri,right:h[t.bottom].line[t.layer].contri}})).filter((function(t){return t.x<v-2})),kt=kt.map((function(t){return{x:(z(t.x)+z(t.x-1))/2,y:(I(h[t.y].line[t.x].position)+I(h[t.y].line[t.x-1].position))/2,row:t.y,col:t.x,delta:Math.abs(t.left-t.right)*(t.left*t.right<0?2:1),left:t.left,right:t.right,removed:!1}})),kt=kt.filter((function(t){return P(t.left)!=P(t.right)})).sort((function(t,e){return e.delta-t.delta})).slice(0,3),Ct=0;Ct<kt.length;++Ct)if(!kt[Ct].removed)for(Mt=Ct+1;Mt<kt.length;++Mt)Math.abs(kt[Ct].row-kt[Mt].row)+Math.abs(kt[Ct].col-kt[Mt].col)<=1&&(kt[Mt].removed=!0);kt=kt.filter((function(t){return!t.removed})),kt.forEach((function(t){h[t.row].line[t.col-1].has_rseg=1})),Ot=Q.selectAll(".phrase").data(it).enter().append("g").attr("class","phrase").style("display","none"),Ot.append("path").attr("d",(function(t){for(var e=(3*z(t.layer-1)+z(t.layer))/4,n=0,r=t.top;r<t.bottom;++r)if(h[r].line[t.layer-1].label!=h[r+1].line[t.layer-1].label){n=r;break}if(!h[t.top].line[t.layer-1].display||!h[n+1].line[t.layer-1].display)return"";h[n].line[t.layer-1].has_rseg=1,h[n+1].line[t.layer-1].has_rseg=1;var a=I((h[n].line[t.layer-1].position+h[n+1].line[t.layer-1].position)/2),o=I(h[n].line[t.layer-1].position),i=I(h[n+1].line[t.layer-1].position);return"M".concat(e-20," ").concat(o," Q").concat(e-10," ").concat(a-2," ").concat(e," ").concat(a-2," M").concat(e-20," ").concat(i," Q").concat(e-10," ").concat(a+2," ").concat(e," ").concat(a+2)})).style("fill","none").style("stroke","rgb(27, 30, 35)").style("opacity",.6).style("stroke-width","2px"),Ot.append("path").attr("transform",(function(t){for(var e=(3*z(t.layer-1)+z(t.layer))/4,n=0,r=t.top;r<t.bottom;++r)if(h[r].line[t.layer-1].label!=h[r+1].line[t.layer-1].label){n=r;break}if(!h[t.top].line[t.layer-1].display||!h[n+1].line[t.layer-1].display)return"";var a=I((h[n].line[t.layer-1].position+h[n+1].line[t.layer-1].position)/2);return"translate(".concat(e+3,",").concat(a,")")})).attr("d",(function(t){return"M".concat(6," ",0," L").concat(-3," ").concat(5.196," L").concat(-3," ").concat(-5.196," Z")})).style("fill","rgb(27, 30, 35)").style("stroke","none").style("opacity",.6).style("stroke-width","2px"),St=Y.selectAll(".relation").data(st).enter().append("g").attr("class","relation"),St.append("path").attr("d",(function(t){var e=I(t.y1),n=I(t.y2);tt&&(2==t.top&&(t.top=6),3==t.top&&(t.top=4),6==t.top&&9==t.bottom&&(t.layer-=2),e=I(h[t.top].line[t.layer-1].position),n=I(h[t.bottom].line[t.layer].position));var r=z(t.layer-2),a=z(t.layer-1),o=z(t.layer),i=h[t.top].line[t.layer-1].contri,s=h[t.top].line[t.layer].contri,l=h[t.bottom].line[t.layer-1].contri,c=h[t.bottom].line[t.layer].contri,u=(B(i)+B(s))/4-.5,f=(B(l)+B(c))/4-.5,d=Math.min(u,f),p=(r+a)/2,g=(a+o)/2;Math.abs(I(h[t.top].line[t.layer-1].position)-I(h[t.top].line[t.layer-2].position))>12&&(p=a,e=I(h[t.top].line[t.layer-1].position)),Math.abs(I(h[t.bottom].line[t.layer-1].position)-I(h[t.bottom].line[t.layer].position))>12&&(g=o,n=I(h[t.bottom].line[t.layer].position)),u=Math.min(u,3*d),f=Math.min(f,3*d);var y=V(p,g,e-u,e+u,n-f,n+f,1);return y})).style("stroke-width",tt?2:.5).style("stroke",(function(t){var e=h[t.top].line[t.layer-2].contri,n=h[t.top].line[t.layer-1].contri,r=h[t.bottom].line[t.layer].contri;e=W(P(e)),n=W(P(n)),r=W(P(r));var a="url(#pattern-".concat(e,"-to-").concat(n,"-to-").concat(r,"-origin)");return a})).style("fill",(function(t){var e=h[t.top].line[t.layer-2].contri,n=h[t.top].line[t.layer-1].contri,r=h[t.bottom].line[t.layer].contri;e=W(P(e)),n=W(P(n)),r=W(P(r));var a="url(#pattern-".concat(e,"-to-").concat(n,"-to-").concat(r,"-origin)");return a})),At=Q.selectAll(".represent").data(kt).enter().append("g").attr("class","represent").attr("transform",(function(t){return"translate(".concat(t.x,",").concat(t.y,")")})),tt?(At.append("rect").attr("x",-12).attr("y",(function(t){return-6.5})).attr("width",24).attr("height",(function(t){return 13})).attr("rx",2).attr("ry",2).style("stroke",(function(t){return P(t.right)})).style("stroke-width",1).style("fill",(function(t){return P(t.right)})),At.append("rect").attr("x",-12).attr("y",(function(t){return-6.5})).attr("width",12).attr("height",(function(t){return 13})).attr("rx",2).attr("ry",2).style("fill",(function(t){return P(t.left)}))):(At.append("rect").attr("x",-9).attr("y",(function(t){return-5})).attr("width",18).attr("height",(function(t){return 10})).attr("rx",2).attr("ry",2).style("stroke",(function(t){return P(t.right)})).style("stroke-width",1).style("fill",(function(t){return P(t.right)})),At.append("rect").attr("x",-9).attr("y",(function(t){return-5})).attr("width",9).attr("height",(function(t){return 10})).attr("rx",2).attr("ry",2).style("fill",(function(t){return P(t.left)}))),G(n),jt=[],h.forEach((function(t,e){for(var a=0;a+1<t.line.length;++a){t.line[a].has_shade=!1;var o=B(t.line[a].contri),i=B(t.line[a+1].contri);if(!t.line[a+1].display)break;a+2<t.line.length&&!t.line[a+2].display&&(i=.5);var s=void 0,l=void 0,c=void 0,u=void 0;s=z(t.line[a].layer),l=z(t.line[a+1].layer),c=I(t.line[a].position)-.5*o,u=I(t.line[a+1].position)-.5*i;var f=n.append("linearGradient").attr("id","pattern-".concat(t.line[a].fill_id)).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%");if(f.append("stop").attr("offset","0%").attr("stop-color",P(t.line[a].contri)),f.append("stop").attr("offset","100%").attr("stop-color",P(t.line[a+1].contri)),t.line[a].show_label&&r(t.text)){var d=M(t.text)[0],h=Math.min(c,u),p=Math.max(c+o,u+i),g=Math.max(s,(s+l)/2-d*(tt?"the"==t.text?.15:.45:.48)),y=Math.min(l,(s+l)/2+d*(tt?"the"==t.text?.15:.45:.48));n.append("clipPath").attr("id","clipping-".concat(t.line[a].fill_id)).append("path").attr("d","M".concat(s," ").concat(h," L").concat(s," ").concat(p," L").concat(g," ").concat(p," L").concat(g," ").concat(h," M").concat(y," ").concat(h," L").concat(y," ").concat(p," L").concat(l," ").concat(p," L").concat(l," ").concat(h))}jt.push({d:V(s,l,c,c+o,u,u+i),opacity:1,fill_id:t.line[a].fill_id,center:{x:(s+l)/2,y:(c+u)/2},baseline:t.line[a].show_label&&r(t.text)?[s,l,c,c+o,u,u+i]:null,label:t.line[a].show_label&&!t.line[a].has_rseg?{text:t.text,pos:t.pos,len:t.len}:null,x:a,y:e})}})),Rt=J.selectAll(".segment").data(jt).enter().append("g").attr("class","segment"),Rt.append("path").attr("d",(function(t){return t.d})).style("clip-path",(function(t){return t.label?"url(#clipping-".concat(t.fill_id,")"):"none"})).style("fill",(function(t){return"url(#pattern-".concat(t.fill_id,")")})).style("stroke","none").style("opacity",(function(t){return t.opacity})),zt=0,It=jt;case 113:if(!(zt<It.length)){t.next=121;break}if(Wt=It[zt],null!=Wt.baseline&&null!=Wt.label){t.next=117;break}return t.abrupt("continue",118);case 117:et.push({anchor:"middle",x0:Wt.center.x,y0:Wt.center.y,fill:"rgb(27, 30, 35)",baseline:Wt.baseline,s1:Wt.label.text.slice(0,Wt.label.pos),s2:Wt.label.text.slice(Wt.label.pos,Wt.label.pos+Wt.label.len),s3:Wt.label.text.slice(Wt.label.pos+Wt.label.len)});case 118:zt++,t.next=113;break;case 121:Gt=Object(i["a"])(h);try{for(Gt.s();!(Et=Gt.n()).done;)Lt=Et.value,et.push({anchor:"start",is_end:Lt.end_point==Lt.line.length-1?1:0,contri:Math.abs(Lt.line[Lt.end_point].contri),x0:z(Lt.end_point)+8,y0:I(Lt.line[Lt.end_point].position)+3,baseline:null,fill:Lt.end_point+1<Lt.line.length?P(Lt.line[Lt.end_point].contri):"rgb(27, 30, 35)",s1:Lt.text.slice(0,Lt.pos),s2:Lt.text.slice(Lt.pos,Lt.pos+Lt.len),s3:Lt.text.slice(Lt.pos+Lt.len)})}catch(Zt){Gt.e(Zt)}finally{Gt.f()}for(Dt=Z.selectAll(".end-label").data(h).enter().append("g").attr("class","end-label"),Nt=Dt.filter((function(t){return!t.line[v-1].display})),Nt.append("circle").attr("cx",(function(t){return z(t.end_point)})).attr("cy",(function(t){return I(t.line[t.end_point].position)})).attr("r",3).style("fill",(function(t){return P(t.line[t.end_point].contri)})).style("stroke",(function(t){return P(t.line[t.end_point].contri)})).style("stroke-width",1.5),et.forEach((function(t){t.all_pieces=[[t.s1,.4],[t.s2,1],[t.s3,.4]].filter((function(t){return t[0].length>0})),t.pieces=[];var e,n="",r=Object(i["a"])(t.all_pieces);try{for(r.s();!(e=r.n()).done;){var a=e.value;if(a[0].length+n.length>O){var o=a[0].slice(0,O-n.length)+"...";t.pieces.push([o,a[1]]),n+=o;break}t.pieces.push(a),n+=a[0]}}catch(Zt){r.e(Zt)}finally{r.f()}var s=M(n);t.width=s[0],t.height=.7*s[1],"end"==t.anchor?(t.x0-=t.width,t.anchor="start"):"middle"==t.anchor&&(t.x0-=.5*t.width,t.y0+=t.height),t.x=t.x0,t.y=t.y0})),Tt=et.filter((function(t){return t.is_end})).sort((function(t,e){return Math.abs(e.contri)-Math.abs(t.contri)})),et=et.filter((function(t){return!t.is_end})),Bt=0;Bt<Tt.length;++Bt)Tt[Bt].display=1;for(Pt=6;Pt<Tt.length;++Pt)for(Vt=0;Vt<Pt;++Vt)Tt[Vt].display&&Math.abs(Tt[Pt].y-Tt[Vt].y)<10&&(Tt[Pt].display=0);Tt=Tt.filter((function(t){return t.display})),et=et.concat(Tt),Ft=u["g"](et).force("x",u["h"](0).strength(0)).force("y",u["i"](0).strength(0)).force("collide",K()),$t=0;case 135:if(!($t<50)){t.next=141;break}return t.next=138,Ft.tick();case 138:++$t,t.next=135;break;case 141:Ht=o.selectAll(".label").data(et).enter().append("text").attr("class","label").attr("fill",(function(t){return t.fill})).attr("text-anchor",(function(t){return t.anchor})).style("font-size",k).style("font-family",C),qt=Ht.filter((function(t){return t.baseline})),Yt=Ht.filter((function(t){return!t.baseline})),qt.append("defs").append("path").attr("id",(function(t,e){return"labelbaseline-".concat(e)})).attr("d",(function(t){var e=t.x-t.x0,n=t.y-t.y0,r=t.baseline;return F(r[0]+e,r[1]+e,r[2]+n,r[3]+n,r[4]+n,r[5]+n)})),Xt=qt.append("textPath").attr("href",(function(t,e){return"#labelbaseline-".concat(e)})).attr("startOffset","50%"),Xt.selectAll("tspan").data((function(t){return t.pieces})).enter().append("tspan").style("opacity",(function(t){return t[1]})).text((function(t){return t[0]})),Ut=Yt.attr("x",(function(t){return t.x})).attr("y",(function(t){return t.y})),Ut.selectAll("tspan").data((function(t){return t.pieces})).enter().append("tspan").style("opacity",(function(t){return t[1]})).text((function(t){return t[0]})),u["z"]("body").selectAll(".svg-tooltip").remove(),Jt=u["z"]("body").append("div").attr("class","svg-tooltip").style("position","absolute").style("visibility","hidden"),Qt=function(t){Jt.selectAll("span").data(t.all_pieces).enter().append("span").text((function(t){return t[0]})),Jt.selectAll("span").data(t.all_pieces).style("opacity",(function(t){return t[1]})).text((function(t){return t[0]+" "})),Jt.selectAll("span").data(t.all_pieces).exit().remove()},qt.on("mouseover",(function(t){return Qt(t),Jt.style("visibility","visible")})).on("mousemove",(function(){return Jt.style("top",u["e"].pageY-10+"px").style("left",u["e"].pageX+10+"px")})).on("mouseout",(function(){return Jt.style("visibility","hidden")})),Yt.on("mouseover",(function(t){return Qt(t),Jt.style("visibility","visible")})).on("mousemove",(function(){return Jt.style("top",u["e"].pageY-10+"px").style("left",u["e"].pageX+10+"px")})).on("mouseout",(function(){return Jt.style("visibility","hidden")}));case 154:case"end":return t.stop()}}),t)}))),H.apply(this,arguments)},$=function(){return H.apply(this,arguments)},a=e.positiveColor,o=e.neutralColor,c=e.negativeColor,f=e.layout,d=f.phrases,h=f.lines.map((function(t,e){var n={};n.text=t.text;for(var r=0,a=0,o=0;o<t.line.length;++o){var i=t.line[o];i.display&&(a=o),i.has_shade=!!i.has_shade,i.fill_id=t.line.length*e+o,o+1<t.line.length&&i.display?o>0&&t.line[o-1].show_label||o+2==t.line.length?i.show_label=0:i.show_label&&o-r>5&&(t.line[Math.floor((r+o)/2)].show_label=1):i.show_label=0,i.show_label&&(r=o)}return n.end_point=a,a+=1,a-r>5&&(t.line[Math.floor((r+a)/2)].show_label=1),n.len=t.len,n.line=t.line,n.tot_contri=t.line.map((function(t){return Math.abs(t.contri)})).reduce((function(t,e){return t+e})),n})),p=h.map((function(t){return t.tot_contri})).sort((function(t,e){return e-t})),g=p[2],y=0;y<h.length;++y)h[y].pos=0,""==h[y].text&&(h[y].text=h[y-1].text,h[y].pos=h[y-1].pos+h[y-1].len);v=h[0].line.length,x=h.length,function(t,e,n){return-1!=t&&(!!h[e].line[t].display&&(!!h[n].line[t].display&&h[n].line[t].label==h[e].line[t].label))},m=function(t){for(var e=[],n=0;n+1<v;++n)for(var r=1,a=0;r<=x;++r)if(!(r<x&&t[r].line[n].label==t[r-1].line[n].label)){var o=r-1,i=function(e,n,r){while(e>n&&(0==r||!t[e].line[r-1].display))--e;while(e>n&&(0==r||!t[n].line[r-1].display))++n;for(var a=-1,o=n;o<=e;++o)if(t[o].line[r].display){1,a=o;break}return[e,n,a]},s=void 0,l=void 0,c=void 0,u=i(o,a,n),f=Object(Z["a"])(u,3);if(s=f[0],l=f[1],c=f[2],s-l>=1&&-1!=c){var d=B(t[l].line[n].contri),h=B(t[s].line[n].contri),p=I(t[l].line[n].position)-.5*d-8,g=I(t[s].line[n].position)+.5*h+8,y=void 0,m=void 0,w=i(o,a,n+1),b=Object(Z["a"])(w,3);y=b[0],m=b[1],b[2];var _=B(t[m].line[n+1].contri),k=B(t[y].line[n+1].contri),C=I(t[m].line[n+1].position),M=I(t[y].line[n+1].position);m!=y&&(C=C-.5*_-8,M=M+.5*k+8);for(var O=t[c].line[n+1].contri,S=t[c].line[n].contri,A=l;A<=s;++A)if(t[A].line[n].display){var j=t[A].line[n+1].contri;Math.abs(j)>Math.abs(O)&&(O=j),j=t[A].line[n].contri,Math.abs(j)>Math.abs(S)&&(S=j)}var R=P(O),z=P(S);z=W(z),R=W(R);var G="url(#pattern-".concat(z,"-to-").concat(R,")");e.push({y1:p,y2:g,y3:C,y4:M,top:l,bottom:s,c1:z,c2:R,fill:G,x:n,y:t[s].line[n].label})}a=r}return e},w=function(t,e){for(var n=[],r=0,a=0,o=0,i=0;i+2<v;++i){while(r<t.length&&t[r].x<i)++r;while(a<t.length&&t[a].x<i+1)++a;while(o<t.length&&t[o].x<i+2)++o;for(var s=new Set,l=r;l<a;++l)for(var c=t[l].top;c<t[l].bottom;++c)s.add(c);if(r<a&&a<o){var u=r,f=a;while(u<a&&f<o)t[u].bottom<t[f].top?++u:(t[u].top>t[f].bottom||(t[u].c1==t[f].c2&&t[u].c2!=t[u].c1?(t[u].c2=t[f].c1=t[f].c2,t[u].fill="url(#pattern-".concat(t[u].c1,"-to-").concat(t[u].c2,")"),t[f].fill="url(#pattern-".concat(t[f].c1,"-to-").concat(t[f].c2,")")):t[u].c2!=t[f].c1&&(t[u].c2=t[f].c1,t[u].fill="url(#pattern-".concat(t[u].c1,"-to-").concat(t[u].c2,")")),(t[u].top>t[f].top||t[u].top<t[f].top)&&(t[u].y3=t[f].y1),++u),++f);u=a-1,f=o-1;while(u>=r&&f>=a)t[u].bottom<t[f].top?--f:t[u].top>t[f].bottom?--u:(t[u].c2!=t[f].c1&&(t[u].c2=t[f].c1,t[u].fill="url(#pattern-".concat(t[u].c1,"-to-").concat(t[u].c2,")")),(t[u].bottom>t[f].bottom||t[u].bottom<t[f].bottom)&&(t[u].y4=t[f].y2),--u,--f)}for(var d=a;d<o;++d){for(var h=1,p=t[d].top;p<t[d].bottom;++p)if(s.has(p)){h=0;break}if(h){var g=t[d].y1,y=t[d].y2,x=t[d].c1,m=I(.5*(e[t[d].bottom].line[i].position+e[t[d].bottom].line[i].position)),w=e[t[d].top].line[i].contri,b=W(P(w)),_="url(#pattern-".concat(b,"-to-").concat(x,")");n.push({y1:m,y2:m,y3:g,y4:y,c1:b,c2:x,top:t[d].top,bottom:t[d].bottom,fill:_,x:t[d].x-1,y:t[d].label})}}}return n},b=document.createElement("canvas"),_=b.getContext("2d"),k=tt?"32px":"20px",C="Roboto, san-serif",_.font=k+" "+C,M=function(t){var e=_.measureText(t),n=e.actualBoundingBoxRight+e.actualBoundingBoxLeft,r=e.actualBoundingBoxAscent+1;return[n,r]},O=16,S=Math.max.apply(Math,Object(s["a"])(h.map((function(t){return M(t.text.slice(0,O))[0]})))),A={top:20,right:10+S,bottom:20,left:20+S},j=e.viewbox.network.width-A.left-A.right,R=e.viewbox.network.height-A.top-A.bottom,h.forEach((function(t,e){for(var n=1;n<t.line.length;++n)tt&&(t.line[n].display=1,e<=6&&(t.line[n].position+=.06,t.line[n].position=Math.min(t.line[n].position,t.line[n-1].position)),1==e&&3==n&&(t.line[n].position-=.02),1==e&&4==n&&(t.line[n].position+=.06),3==e&&2==n&&(t.line[n].position-=.02),3==e&&n>=3&&(t.line[n].position=t.line[n-1].position),9==e&&n>=3&&(t.line[n].position=t.line[10].position),e>6&&n>=6&&(t.line[n].label+=1),("the"==t.text||"a"==t.text)&&n>8&&(t.line[n].display=0,t.end_point=9),"was"==t.text&&n>9&&(t.line[n].display=0,t.end_point=10),"'"==t.text&&n>7&&(t.line[n].display=0,t.end_point=8),"the"==t.text&&4==n&&(t.line[n].position-=.12),"the"==t.text&&n>=4&&n<=9&&(t.line[n].label+=1),"good"==t.text&&n<6?t.line[n].contri=-Math.abs(t.line[n].contri):t.line[n].contri=Math.abs(t.line[n].contri),"good"==t.text&&6==n&&(t.line[n].contri=Math.abs(t.line[n+1].contri)),"good"==t.text&&(t.line[n].contri*=1.2),"n"==t.text&&(t.line[n].contri=1.2*Math.abs(h[8].line[n].contri)),"a"==t.text&&n<=5&&(t.line[n].label=-1));console.log(t.text,t.line.map((function(t){return t.contri})))})),z=u["t"]().domain(h[0].line.map((function(t){return t.layer}))).rangeRound([0,j]),I=u["r"]().domain([1,0]).range([10,R]),W=function(t){return t==a?"pos":t==c?"neg":t==o?"neu":"unknown"},G=function(t){for(var e=[[a,W(a)],[c,W(c)],["#BBDEFB","neu"]],n=[[a,W(a)],[c,W(c)],["gray","neu"]],r=0,o=e;r<o.length;r++){var s,l=o[r],f=Object(i["a"])(e);try{for(f.s();!(s=f.n()).done;){var d=s.value,h=t.append("linearGradient").attr("id","pattern-".concat(l[1],"-to-").concat(d[1])).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%");h.append("stop").attr("offset","0%").attr("stop-color",u["k"]("white",l[0])(.2)),h.append("stop").attr("offset","100%").attr("stop-color",u["k"]("white",d[0])(.2))}}catch(C){f.e(C)}finally{f.f()}}for(var p=0,g=n;p<g.length;p++){var y,v=g[p],x=Object(i["a"])(n);try{for(x.s();!(y=x.n()).done;){var m,w=y.value,b=Object(i["a"])(n);try{for(b.s();!(m=b.n()).done;){var _=m.value,k=t.append("linearGradient").attr("id","pattern-".concat(v[1],"-to-").concat(w[1],"-to-").concat(_[1],"-origin")).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%");k.append("stop").attr("offset","0%").attr("stop-color",u["k"]("white",v[0])(1)),k.append("stop").attr("offset","50%").attr("stop-color",u["k"]("white",w[0])(1)),k.append("stop").attr("offset","100%").attr("stop-color",u["k"]("white",_[0])(1))}}catch(C){b.e(C)}finally{b.f()}}}catch(C){x.e(C)}finally{x.f()}}},E=(n=[]).concat.apply(n,Object(s["a"])(f.lines.map((function(t){return t.line.map((function(t){return Math.abs(t.contri)}))})))).sort((function(t,e){return t-e})),L=x*v<60?E[~~(.36*E.length)]:x*v<120?E[~~(.48*E.length)]:E[~~(.6*E.length)],0==L&&(L=E.filter((function(t){return t>0}))[0]),D=E[E.length-1],h.forEach((function(t){for(var e=1;e<t.line.length-1;++e){var n=t.line[e-1].contri,r=t.line[e+1].contri;(Math.abs(n)<L&&Math.abs(r)<L||Math.abs(n)>L&&Math.abs(r)>L)&&n*r>0&&(t.line[e].contri=.5*(n+r))}})),N=(r=[]).concat.apply(r,Object(s["a"])(f.lines.map((function(t){return t.line.filter((function(t){return t.display})).map((function(t){return Math.abs(t.contri)}))})))).sort((function(t,e){return t-e})),T=N[~~(.66*N.length)],B=function(){var t=T,e=D,n=12,r=1.8;2*t>e&&(r=4);var a=u["r"]().range([1.2,r,n]).domain([0,t,e]);return tt&&(a=u["r"]().range([1.2,1.5,12]).domain([0,t,e])),function(t){return t=Math.abs(t),a(t)}}(),P=function(){var t=L,e=-t,n=t;return function(t){return t<=e+1e-5?a:t>=n-1e-5?c:o}}(),V=function(t,e,n,r,a,o){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=t+.5*(e-t),l=t+.5*(e-t),c=t+.15*(e-t),u=t+.85*(e-t);return(i||Math.abs(o-r)<40)&&(c=t,u=e,s=t+.5*(e-t),l=t+.5*(e-t)),"M".concat(t," ").concat(n,"L").concat(t," ").concat(r," L").concat(c," ").concat(r," C").concat(s," ").concat(r," ").concat(l," ").concat(o," ").concat(u," ").concat(o," L").concat(e," ").concat(o," L").concat(e," ").concat(a," L").concat(u," ").concat(a," C").concat(l," ").concat(a," ").concat(s," ").concat(n," ").concat(c," ").concat(n," z")},F=function(t,e,n,r,a,o){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.4,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:.6,l=t+(e-t)*i,c=t+(e-t)*s;if(n=r+8,r=o+8,Math.abs(n-r)<12){var u=(n+r)/2;n=r=u}return"M".concat(t-50," ").concat(n," L ").concat(t," ").concat(n,"C").concat(l," ").concat(n," ").concat(c," ").concat(r," ").concat(e," ").concat(r," L ").concat(e+50," ").concat(r)},$();case 45:case"end":return t.stop()}}),t)}))),nt.apply(this,arguments)}var rt=et,at=function(t){return/^[a-zA-Z]+$/.test(t)},ot={name:"App",computed:Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(h["e"])(["DAG","viewbox","linechart","bubble","showed_layers","config","labels","color_scheme","neuron_clusters","all_samples","color_candidates","selected_class","treemap","current_node","current_layers","edges","layers","sentenceclusters","scatterplot","current_viewtype","layout","tooltip","server_url","filter_info","matrix","parameters"])),Object(h["c"])(["getSamples","getWordIdxs","view_samples","selected_label","fontSizeRange","getSample","positiveColor","negativeColor","neutralColor","neutralColorGray","getLabelColor"])),{},{word_attrs:function(){return{frequency:this.frequency_weight/10,uncertainty:this.uncertainty_weight/10,entropy:this.entropy_weight/10}}}),components:{WordGroup:H,InfoTooltip:Q},data:function(){return{datasets:["SST-2"],models:["BERT 12-Layer"],chips:[],is_lasso_select_all:!0,enable_word_filter:!1,left_top_view:"matrix",is_wordview_init:!1,right_bottom_view:"info_flow",left_bottom_view:"samples",right_top_view:"word",enable_word_attr:!1,enable_tooltip:!1,show_trending_up:!1,show_trending_down:!1,trending_down_lines:[],trending_up_lines:[],trending_down_underlines:[],trending_up_underlines:[],enable_word_highlight:!1,current_color_scheme:0,dataset_name:"",n_layer:0,sentences:null,current_text:"",frequency_weight:10,uncertainty_weight:10,entropy_weight:10,infolossWords:[],overviewWords:[],selectedSentence:null,current_items:[],current:{items:[],keywords:[]},currentGrids:null,currentGridsData:null,selectedGrids:null,lasso:null,listOrderKey:"p score",listOrder:1,word_cache:{},total_accuracy:100,search_expand:!1,is_refreshing:!1,lastInfoFlow:null,lastWordContext:null,xi_threshold:.02,labelColor:["#d7191c","#1a9641","#1f77b4","#ff7f0e"]}},methods:Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(h["d"])(["calcDAG","updatePosition","setViewtype","setLayers","setNetwork","calcEdges","showTooltip","hideTooltip","addHoverTimer","removeHoverTimer","setHoverWord"])),Object(h["b"])(["changeCurrentSamples","fetchAllSample","fetchLayerInfo","fetchWordIndex","changeFilteredWord","startSync","endSync","fetchScatterplot","selectClass","fetchMatrix"])),{},{onDialogOpen:function(){var t=this;setTimeout((function(){var e=d().data(t.parameters.xi_values.map((function(t){return{value:t}}))).datatype("number").x("value").scale("log").width(t.config.histogram_width).height(t.config.histogram_height).color(t.config.histogram_color);u["z"](t.$refs.xi_distribution).selectAll("*").remove(),u["z"](t.$refs.xi_distribution).append("g").attr("class","histogram").attr("transform","translate(0, 0)").call(e)}),50)},rightClickSearchItem:function(t){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!isNaN(+t)){n.next=7;break}return n.next=3,e.fetchWordIndex(t);case 3:r=e.getWordIdxs(t),r.length>=8&&C.$emit("add_word_DAG",t),n.next=7;break;case 7:case"end":return n.stop()}}),n)})))()},changeRightBottomView:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("word_ctx"!=t.right_bottom_view){e.next=6;break}return t.right_bottom_view="info_flow",e.next=4,t.addSentenceDAG(t.lastInfoFlow);case 4:e.next=9;break;case 6:return t.right_bottom_view="word_ctx",e.next=9,t.addWordDAG(t.lastWordContext);case 9:case"end":return e.stop()}}),e)})))()},clickSearchItem:function(t){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!isNaN(+t)){n.next=7;break}return n.next=3,e.fetchWordIndex(t);case 3:return n.next=5,e.changeFilteredWord(t);case 5:n.next=10;break;case 7:return 145==+t&&(t-=10),n.next=10,e.addSentenceDAG(+t);case 10:case"end":return n.stop()}}),n)})))()},removeSearchItem:function(){this.chips.splice(this.chips.indexOf(item),1),this.chips=Object(s["a"])(this.chips)},onClickSearch:function(){0==this.search_expand?this.search_expand=!0:this.search_expand=!1},wordInteraction:function(t){var e=null,n=this;return t.on("click",function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=n.word_cache[e.text],a=r.data.idxs,a.length>=10&&n.addWordDAG(e.text);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).on("mouseover",(function(t){if(at(t.text)&&!(t.text.length<=1)&&-1==t.text.indexOf("_")){e=t.text;var r=u["e"].pageX+10,a=u["e"].pageY-10,o=function(){var o=Object(l["a"])(regeneratorRuntime.mark((function o(){var i,s,l,c,u;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(i=null,!n.word_cache[t.text]){o.next=5;break}i=n.word_cache[t.text],o.next=9;break;case 5:return o.next=7,y.a.post("".concat(n.server_url,"/api/word"),{word:t.text});case 7:i=o.sent,n.word_cache[t.text]=i;case 9:for(s=i.data.idxs,l=i.data.info,c=1;c<l.length;++c)l[c]=Math.min(l[c-1],l[c]);return n.highlightGrid(s),u="<p>".concat(t.text,", ").concat(s.length," samples </p>"),o.next=16,n.getSamples(s);case 16:i=o.sent,u+=i.slice(0,8).map((function(t,e){return"#".concat(e+1,": ").concat(t.text)})).join("</br>"),e==t.text&&n.showTooltip({top:a,left:r,content:u});case 19:case"end":return o.stop()}}),o)})));return function(){return o.apply(this,arguments)}}();setTimeout((function(){e==t.text&&o()}),500)}})).on("mouseout",(function(t){e=null,n.hideTooltip(),n.highlightGrid(null)}))},brushGrid:function(t){t&&0!=t.length?(t=new Set(t),this.currentGrids.style("opacity",(function(e){for(var n=0;n<e.length;++n)if(t.has(e[n].index))return 1;return.4}))):(this.currentGrids.style("opacity",1),t=[]),this.changeCurrentSamples(Object(s["a"])(t))},getWordFillColor:function(t){var e=this.getWordColor(t);return e==this.neutralColorGray?"rgb(172, 196, 220)":e},getWordColor:function(t){return S(this,t)},highlightGrid:function(t){if(t&&0!=t.length){t=new Set(t);var e=this.currentGrids.filter((function(e){for(var n=0;n<e.length;++n)if(t.has(e[n].index))return!0;return!1})),n=this.currentGrids.filter((function(e){for(var n=0;n<e.length;++n)if(t.has(e[n].index))return!1;return!0}));n.select("path.hexagon").style("stroke","white").style("stroke-width",.5).style("opacity",.5),e.select("path.hexagon").style("stroke","orange").style("stroke-width",1).style("opacity",1)}else t=new Set,this.currentGrids.select("path.hexagon").style("stroke","white").style("stroke-width",.5).style("opacity",1)},svgResize:function(){var t=document.getElementById("network-svg").parentElement.getBoundingClientRect(),e=document.getElementById("overview-svg").parentElement.getBoundingClientRect(),n=document.getElementById("linechart-svg").parentElement.getBoundingClientRect();t.width-=8,e.width-=8,n.width-=8,t.height-=8,e.height-=38,n.height-=32,u["z"]("#network-svg").attr("width",t.width).attr("height",t.height).attr("viewBox","0 10 ".concat(this.viewbox.network.width+10," ").concat(this.viewbox.network.height+40)),u["z"]("#overview-svg").attr("width",e.width).attr("height",e.height).attr("viewBox","0 10 ".concat(this.viewbox.overview.width+10," ").concat(this.viewbox.overview.height+40)),u["z"]("#linechart-svg").attr("width",n.width).attr("height",n.height).attr("viewBox","0 10 ".concat(this.viewbox.linechart.width+10," ").concat(this.viewbox.linechart.height+40)),this.updatePosition({network:t,bubble:e,linechart:n});u["z"]("#linechart-g").attr("transform","translate(".concat(this.linechart.x,",").concat(this.linechart.y,")"))},paintWordcloud:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,G(t);case 2:case"end":return e.stop()}}),e)})))()},paintMatrix:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var n,r,a,o,i,s,c,f,d,h,p,g,y,v,x,m,w,b,_,k,C;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:C=function(t){var e=u["z"](this).selectAll(".cell").data(t).enter().append("g").attr("class","cell").attr("transform",(function(t){return"translate(".concat(x(t.target),", 0)")}));e.append("rect").attr("width",x.bandwidth()).attr("height",x.bandwidth()).style("fill-opacity",1).style("stroke","lightgray").style("stroke-width",0).style("fill",(function(t){return w(t)})),e.append("text").attr("x",x.bandwidth()/2).attr("y",x.bandwidth()/2+7).style("text-anchor","middle").style("font-size","18px").style("font-weight",500).style("fill",(function(t){return t.val>.9?"white":"black"})).text((function(t){return Number(t.val).toFixed(3)})),e.on("mouseover",(function(t){u["A"](".cell").style("opacity","0.1"),u["A"](".cell").filter((function(e){return(e.source==t.source||e.source==t.target)&&(e.target==t.source||e.target==t.target)})).style("opacity","1").append("rect").attr("class","hovered").attr("width",x.bandwidth()).attr("height",x.bandwidth()).style("fill","none").style("stroke","gray").style("stroke-width",1.5),_.filter((function(e){return e[0].source===t.source})).style("fill","#000").style("font-weight","bold"),k.filter((function(e){return e[0].source===t.target})).style("fill","#000").style("font-weight","bold")})).on("mouseout",(function(){u["A"](".cell").style("opacity","1"),u["A"](".cell").select(".hovered").remove(),_.style("fill",null).style("font-weight",null),k.style("fill",null).style("font-weight",null)})).on("click",function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.onSelectClass(e.classes);case 2:n.left_top_view="corpus",n.is_wordview_init=1;case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.append("title").text((function(t){return t.val}))},w=function(t){var e=t.val;return t.source,t.target,p(+e)},n=t,r=u["z"]("#matrix-g").attr("class","matrixdiagram"),a={left:120,top:150,right:10,bottom:10},o=50,i=t.viewbox.overview.width,s=t.viewbox.overview.height,c=t.matrix,f=c.data.map((function(t){return t.reduce((function(t,e){return t+e}))})),d=c.labels,h=d.map((function(t,e){return d.map((function(n,r){return{source:t,target:n,classes:[e,r],val:c.data[e][r]/f[e]}}))})),p=u["v"]((function(t){return u["j"]("white","gray")(t)})),g=u["v"]((function(t){return u["j"]("white","gray")(t)})),g.domain([0,u["m"](h.flat().filter((function(t){return t.source!=t.target})).map((function(t){return Number(t.val)})))]),p.domain([0,u["m"](h.flat().filter((function(t){return t.source==t.target})).map((function(t){return Number(t.val)})))]),y=i-a.left-a.right,v=s-a.top-a.bottom,y=v=Math.min(y,v)-o,x=u["q"]().rangeRound([0,y]).paddingInner(0).align(0).domain(d),m=r.append("g").attr("transform","translate("+a.left+","+a.top+")"),m.append("text").attr("x",y/2).attr("y",-41).style("text-anchor","middle").text("Predicted Class"),m.append("text").attr("x",-y/2).attr("y",-100).attr("transform","rotate(270)").style("text-anchor","middle").text("Ground Truth"),b=m.selectAll("g.row").data(h).enter().append("g").attr("transform",(function(t){return"translate(10,".concat(x(t[0].source),")")})).each(C),_=b.append("text").attr("class","label").attr("x",-4).attr("y",x.bandwidth()/2).attr("dy","0.32em").attr("text-anchor","end").text((function(t){return t[0].source})),k=m.selectAll("g.column").data(h).enter().append("text").attr("class","column label").attr("transform",(function(t){return"translate(".concat(x(t[0].source),",").concat(-x.bandwidth()/2-10,")")})).attr("x",4).attr("y",x.bandwidth()/2).attr("dy","0.32em").attr("dx","0.32em").text((function(t){return t[0].source}));case 26:case"end":return e.stop()}}),e)})))()},paintScatterplot:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var n,r,a,o,c,f,d,h,g,y,v,m,w,b,k,S,A,j,R,z,I,W,G,E,L,D,N,T,B,P;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(P=function(){return P=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,n,r,a,o,i,l,c,w,b,k,S,G,E,L,P,V,F,$,H,q,Y,X,U,J,Q,Z,K,tt,et,nt,rt,at,ot,it,st,lt,ct,ut;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(at=function(t,n){var r=S.filter((function(e){return e&&e.y>=t&&e.y<n}));if(r=r.sort((function(t,e){return t.x-e.x})),0!=r.length)for(var a=r[0].x,o=1;o<=r.length;++o)if(!(o!=r.length&&r[o].x-r[o-1].x<=30*z)){var i=r[o-1].x+z;i+10*z>e&&(i=e),rt.push({x0:a-z-5,x1:i+5,y0:t-5,y1:n+5}),o!=r.length&&(a=r[o].x)}},e=f-(v+d/A),n=N(d,W),r=[10,e],a=u["r"](I,n),o=u["r"](R,r),i=u["c"](a).tickValues(I).tickFormat((function(t){return Number(t).toFixed(2)})),l=[d/A*.15,d/A*.4],c=u["w"](u["f"](W,(function(t){return t.counts[0]+t.counts[1]})),l),w=Object(p["a"])().radius(z).x((function(t){return t.x})).y((function(t){return t.y})),b=h.scatters.map((function(t,e){return{x:o(t.y),y:a(t.x),is_correct:t.is_correct,pred:t.pred,label:t.label,index:t.id}})),k=w(b),k.forEach((function(t,e){t.count=0,t.error=0,t.length>=1?t[0].pred==g.selected_label[0]?(t.color=g.positiveColor,t.error_color=g.negativeColor):(t.color=g.negativeColor,t.error_color=g.positiveColor):t.color="gray";for(var n=0;n<t.length;++n)t[n].is_correct?t.count+=1:t.error+=1})),S=k,g.currentGridsData=S,G=[0,1,Math.max.apply(Math,Object(s["a"])(k.map((function(t){return t.count}))))],E=u["r"](G,[0,.3,.8]),L=[0,1,Math.max.apply(Math,Object(s["a"])(k.map((function(t){return t.error||0}))))],P=u["r"](L,[0,.5,.8]),V=0,F=0,W.forEach((function(t,e){t.height=a(t.left)-a(t.right),t.r=c(t.counts[0]+t.counts[1]);var n=2*e+2<=A?t.counts[0]:t.counts[1];t.acc=Number(n/(t.counts[0]+t.counts[1])*100).toFixed(2),V+=n,F+=t.counts[0]+t.counts[1],console.log(e,n,t.counts[0]+t.counts[1],Number(n/(t.counts[0]+t.counts[1])*100).toFixed(2))})),g.total_accuracy=Number(V/F*100).toFixed(2),$=u["a"]().startAngle((function(t){return-t.p*Math.PI})).endAngle((function(t){return t.p*Math.PI})).innerRadius((function(t){return 0})).outerRadius((function(t){return c(t.counts[0]+t.counts[1])})),m.selectAll(".strip").data(W).join((function(t){var e=t.append("g").attr("class","strip").attr("transform",(function(t){return"translate(0, ".concat(a(t.right),")")}));e.append("rect").attr("width",f).attr("height",(function(t){return t.height})).attr("fill",(function(t,e){return W[e].is_top?g.negativeColor:g.positiveColor})).style("stroke","none").style("stroke-width",1).style("stroke-opacity",(function(t,e){var n=2*D((W[e].is_top?t.counts[0]:t.counts[1])+1);return n>.25?0:n})).style("fill-opacity",(function(t,e){return D((W[e].is_top?t.counts[0]:t.counts[1])+1)})).on("dblclick",(function(t,e){null==j?(t.weight=5,j=t):j.index==e?(t.weight=1,j=null):null!=j&&(j.weight=1,t.weight=5,j=t),endLoading(),B()}));var n=e.filter((function(t){return t.counts[0]+t.counts[1]>0})).append("g").attr("class","percentage").attr("transform",(function(t,e){return"translate(".concat(f-v-8,", ").concat(t.height/2,")")}));return n.append("circle").attr("r",(function(t){return t.r})).attr("fill",(function(t,e){return t.counts[0]>=t.counts[1]?g.negativeColor:g.positiveColor})).style("opacity",1).on("click",(function(t){var e=h.scatters.filter((function(e){return e.x>=t.left&&e.x<t.right&&!e.is_correct})).map((function(t){return t.id}));C.$emit("brush_grid",e)})),n.append("path").attr("d",$).attr("fill",(function(t,e){return t.counts[0]<t.counts[1]?g.negativeColor:g.positiveColor})).style("opacity",1).on("click",(function(t){var e=h.scatters.filter((function(e){return e.x>=t.left&&e.x<t.right&&!e.is_correct})).map((function(t){return t.id}));C.$emit("brush_grid",e)})),e}),(function(t){t.transition().duration(y).attr("transform",(function(t){return"translate(0, ".concat(a(t.right),")")})),t.select("rect").transition().duration(y).attr("height",(function(t){return t.height})),t.filter((function(t){return t.counts[0]+t.counts[1]>0})).select("g.percentage").transition().duration(y).attr("transform",(function(t,e){return"translate(".concat(f-v-8,", ").concat(t.height/2,")")}))})),m.selectAll(".grid").data(S,(function(t){return Math.floor(t.y)*~~e+Math.floor(t.x)})).join((function(t){var e=t.append("g").attr("class","grid").style("opacity",0);e.append("path").attr("class","hexagon").attr("d",(function(t){return"M ".concat(t.x," ").concat(t.y," ").concat(w.hexagon())})).style("stroke",(function(t){return 0==t.count?"none":"white"})).style("stroke-width",.5).style("fill",(function(t){return t.color})).style("fill-opacity",(function(t){return E(t.count)})),e.append("path").attr("class","cross").attr("transform",(function(t){return"translate(".concat(t.x,",").concat(t.y,")")})).attr("d","M -3 -3 L 3 3 M 3 -3 L -3 3").style("stroke",(function(t){return t.error_color})).style("stroke-width",2.5).style("opacity",(function(t){return P(t.error)}));e.on("mouseover",(function(t){t,u["z"](this).append("path").attr("class","hexagon_outline").attr("d",(function(t){return"M ".concat(t.x," ").concat(t.y," ").concat(w.hexagon())})).style("stroke","orange").style("stroke-width",2).style("fill","none")})).on("mouseout",(function(t){null,u["z"](this).select("path.hexagon_outline").remove()})).on("click",(function(t){var e=t.map((function(t){return t.index})),n=new Set(e);n.has(145)?g.addSentenceDAG(145):n.has(1733)?g.addSentenceDAG(1733):g.addSentenceDAG(e[0]),g.refreshSelection(e)})),e.transition().duration(y).style("opacity",1)}),(function(t){t.select("path.hexagon").transition().duration(y).attr("d",(function(t){return"M ".concat(t.x," ").concat(t.y," ").concat(w.hexagon())})).style("fill",(function(t){return t.color})).style("fill-opacity",(function(t){return E(t.count)})),t.select("path.cross").transition().duration(y).attr("transform",(function(t){return"translate(".concat(t.x,",").concat(t.y,")")})).style("stroke",(function(t){return t.error_color})).style("opacity",(function(t){return t.error?.7:0}))}),(function(t){t.transition().duration(y).style("opacity",0).remove()})),H=m.selectAll(".grid"),g.currentGrids=H,q=function(){},Y=0,X=function(){new Date-Y<=100||(Y=new Date,J.possibleItems().style("opacity",1),J.possibleItems().nodes().length>0?J.notPossibleItems().style("opacity",.4):J.notPossibleItems().style("opacity",1))},U=function(){setTimeout((function(){var t;if(!g.is_refreshing){J.selectedItems().nodes().length>0?J.notSelectedItems().style("stroke",.4):J.notSelectedItems().style("stroke",1),J.selectedItems().style("opacity",1);var e=J.selectedItems().data(),n=(t=[]).concat.apply(t,Object(s["a"])(e.map((function(t){return t.map((function(t){return t.index}))}))));console.log("self.is_lasso_select_all",g.is_lasso_select_all),g.is_lasso_select_all||(n=n.filter((function(t){return g.all_samples[t].wrong}))),g.refreshSelection(n,e)}}),100)},J=_().closePathDistance(305).closePathSelect(!0).targetArea(m).items(H).on("start",q).on("draw",X).on("end",U),g.lasso=J,m.select("g.grid-lasso").remove(),m.append("g").attr("class","grid-lasso").call(J),m.select("g.x-axis").remove(),Q=m.append("g").attr("class","x-axis").attr("transform","translate(".concat(0,",",0,")")).call(i),Q.select(".domain").remove(),Q.selectAll("text").attr("font-size","16px").style("font-family","Roboto, san-serif"),Z=h.keywords,O(Z,g,-1),window.keywords=Z,Z=JSON.parse(JSON.stringify(Z)),u["f"](Z,(function(t){return t.value})),K=Z.filter((function(t){return g.getWordColor(t)==g.negativeColor})).sort((function(t,e){return e.value-t.value})),tt=Z.filter((function(t){return g.getWordColor(t)==g.positiveColor})).sort((function(t,e){return e.value-t.value})),et=0;et<tt.length&&et<K.length;++et)K[et].value<tt[et].value?K[et].value=tt[et].value-.001:tt[et].value=K[et].value-.001;for(Z=Z.sort((function(t,e){return e.value-t.value})),nt=4==g.n_layer?M(g.fontSizeRange,Z.map((function(t){return t.value})),4,[4,10,12]):M(g.fontSizeRange,Z.map((function(t){return t.value})),4,[4,8,10]),Z.forEach((function(t){return t.size=Math.min(nt(t.value),g.fontSizeRange[1])})),rt=[],ot=0;ot<A;++ot){if(it=a(W[ot].right),st=a(W[ot].left),W[ot].weight>1)for(lt=(st-it)/3,ct=0;ct<3;++ct)at(it+ct*lt,it+(ct+1)*lt);else at(it,st);rt.push({x0:2*ot<=A?0:.66*e,x1:2*ot<=A?.33*e:e,y0:it,y1:st})}rt.push({x0:e-40,x1:e,y0:d-15,y1:d}),rt.push({x0:0,x1:e,y0:0,y1:20}),rt.push({x0:0,x1:e,y0:d-20,y1:d}),rt.push({x0:0,x1:10,y0:0,y1:100}),ut={},T.forEach((function(t,e){ut[t.word]=e,t.is_new=!1})),x().size([e,d]).data(Z).text((function(t){return t.word})).barriers(rt).rangex((function(t){if(ut[t.word]){var n=T[ut[t.word]].x/e,r=n-.1,a=n+.1;return[Math.max(0,r),Math.min(a,1)]}return g.getWordColor(t)==g.positiveColor?[0,.5,.25]:g.getWordColor(t)==g.negativeColor?[.6,1,.82]:[.3,.8,.55]})).padding(6).rangey((function(t){if(ut[t.word]){var e=T[ut[t.word]].y/d,n=e-.1,r=e+.1;return[Math.max(0,n),Math.min(r,1),e]}return g.getWordColor(t)==g.positiveColor?[.1,.4,.25]:g.getWordColor(t)==g.negativeColor?[.4,1,.65]:[.2,.6,.5]})).fontSize((function(t){return t.size})).font("Roboto").fontWeight((function(t){return nt(t.value)>=0?"bold":"normal"})).start((function(t){var e=t.filter((function(t){return t.display})).map((function(t){return{x:t.x,y:t.y,layer:0,size:t.size,text:t.text,display:t.display,width:t.width,height:t.height,weight:"bold",id:"corpus",highlight:t.highlight,fill:g.getWordColor(t),contri:t.contri}})),n=e.filter((function(t){return g.getWordColor(t)==g.negativeColor})),r=e.filter((function(t){return g.getWordColor(t)==g.positiveColor})),a=e.filter((function(t){return g.getWordColor(t)!=g.negativeColor&&g.getWordColor(t)!=g.positiveColor}));g.overviewWords=n.slice(0,25).concat(r.slice(0,25)).concat(a.slice(0,20))}));case 60:case"end":return t.stop()}}),t)}))),P.apply(this,arguments)},B=function(){return P.apply(this,arguments)},n=u["z"]("#overview-g"),r=t.bubble.left,a=15,o=t.bubble.top,c=8,f=t.viewbox.overview.width-r-o,d=t.viewbox.overview.height-a-c-18,h=t.scatterplot,g=t,g.dataset_name=t.scatterplot.dataset,g.n_layer=t.scatterplot.n_layer,200,y=2e3,v=10,n.append("clipPath").attr("id","clip_path").append("rect").attr("x",0).attr("y",0).attr("width",f).attr("height",d),m=n.append("g").attr("class","main_layer").attr("transform","translate(".concat(r,", ").concat(a,")")),n.append("g").attr("class","word_layer").attr("transform","translate(".concat(r,", ").concat(a,")")),w=n.append("g").attr("class","label_layer").attr("transform","translate(".concat(r,", ").concat(a,")")).style("font-family","sans-serif").style("font-size",16),w.append("g").attr("transform","translate(".concat(3,",",-2,")")).append("text").style("font-family","Roboto, san-serif").text("Prediction Score"),b=.0625,k=u["f"](h.scatters,(function(t){return t.x})),S=[0,1],h.scatters.forEach((function(t){return t.x=(t.x-k[0])/(k[1]-k[0])*(S[1]-S[0])*.97+.015})),console.log(S),S[0]=Math.floor(20*S[0])/20,S[1]=Math.ceil(20*S[1])/20,A=Math.floor((S[1]-S[0])/b+1e-7),j=null,R=u["f"](h.scatters,(function(t){return t.y})),z=f/A/4*.5/Math.sqrt(.75),z*Math.sqrt(.75),I=[],W=[],G=function(t){var e=S[0]+t*(S[1]-S[0])/A,n=S[0]+(t+1)*(S[1]-S[0])/A;I.push(e);var r=[0,0];h.scatters.filter((function(t){return t.x>=e&&t.x<n})).forEach((function(t){var e=+(t.label==g.selected_label[0]);r[e]=(r[e]||0)+1}));var a=0;r[0]+r[1]>0&&(a=(e<.5-1e-7?r[1]:r[0])/(r[0]+r[1])),W.push({left:e,right:n,counts:r,weight:1,index:t,is_top:e<.5-1e-7,p:a})},E=0;E<A;++E)G(E);I.push(S[1]),Math.min.apply(Math,Object(s["a"])(W.map((function(t){return Math.min(t.counts[0],t.counts[1])})))),L=Math.max.apply(Math,Object(s["a"])(W.map((function(t){return Math.max(t.counts[0],t.counts[1])})))),D=u["s"]().domain([1,L+1]).range([.03,.35]),N=function(t,e){var n,r=0,a=Object(i["a"])(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;r+=o.weight}}catch(c){a.e(c)}finally{a.f()}for(var s=[1],l=0;l<e.length;++l)s.push(s[l]-e[l].weight/r);return s.map((function(e){return e*t}))},null,T=[],B();case 45:case"end":return e.stop()}}),e)})))()},paintLinechart:function(){var t=arguments,e=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.length>0&&void 0!==t[0]?t[0]:null,n.next=3,A(e,r,e.fontSizeRange);case 3:case"end":return n.stop()}}),n)})))()},saveWordAttr:function(){this.enable_word_attr=!1,this.refreshLinechart()},refreshLinechart:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.fetchLayerInfo({idxs:t.current&&t.current.idxs||null,attrs:t.word_attrs});case 2:t.paintLinechart();case 3:case"end":return e.stop()}}),e)})))()},refreshSelection:function(t){var e=arguments,n=this;return Object(l["a"])(regeneratorRuntime.mark((function r(){var a,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.length>1&&void 0!==e[1]?e[1]:null,n.is_refreshing=!0,o=n,r.next=5,n.fetchLayerInfo({idxs:t,attrs:n.word_attrs});case 5:return n.current={},r.next=8,o.getSamples(t);case 8:i=r.sent,n.current_items=i.sort((function(t,e){return t.score-e.score})),n.current.grids=a,n.current.idxs=t,n.paintLinechart(),n.brushGrid(t),n.is_refreshing=!1;case 15:case"end":return r.stop()}}),r)})))()},addSentenceDAG:function(t){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.lastInfoFlow=t,n.next=3,e.refreshDAG("sentence",t);case 3:return n.next=5,e.paintLinechart();case 5:case"end":return n.stop()}}),n)})))()},addWordDAG:function(t){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.lastWordContext=t,n.next=3,e.refreshDAG("word",t);case 3:case"end":return n.stop()}}),n)})))()},refreshDAG:function(t,e){var n=this;return Object(l["a"])(regeneratorRuntime.mark((function r(){var a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a={level:t,layers:n.showed_layers},"sentence"==t?a.idx=e:a.word=e,n.setViewtype(t),startLoading(),r.next=6,y.a.post("".concat(n.server_url,"/api/networks"),a);case 6:o=r.sent,"sentence"==t&&(n.current_text=n.getSample(e).text,n.setLayers(o.data.linechart)),n.setNetwork(o),n.calcDAG(),n.paintDAG(),endLoading();case 12:case"end":return r.stop()}}),r)})))()},paintDAG:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("word"!=t.current_viewtype){e.next=7;break}return t.right_bottom_view="word_ctx",z(t),e.next=5,t.paintWordcloud();case 5:e.next=11;break;case 7:if("sentence"!=t.current_viewtype){e.next=11;break}return t.right_bottom_view="info_flow",e.next=11,rt(t);case 11:case"end":return e.stop()}}),e)})))()},onSelectClass:function(t){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.selectClass(t);case 2:return n.next=4,e.fetchScatterplot();case 4:return n.next=6,e.paintScatterplot();case 6:return n.next=8,e.refreshSelection(null);case 8:case"end":return n.stop()}}),n)})))()}}),mounted:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"body",e={useCSS:!0},n=document.getElementById(t),r=Number(n.getAttribute("width")),a=Number(n.getAttribute("height")),o=new PDFDocument({compress:!1,size:[r,a]});console.log(r,a),SVGtoPDF(o,n,0,0,e);var i=o.pipe(blobStream());i.on("finish",(function(){var t=i.toBlob("application/pdf");navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(t,"File.pdf"):document.getElementById("pdf-file").contentWindow.location.replace(URL.createObjectURL(t))})),o.end()},startLoading(),window.createPdf=n,r=t,r.svgResize(),window.onresize=function(){},t.$intro().start(),e.next=9,t.fetchMatrix();case 9:return e.next=11,t.fetchAllSample();case 11:t.paintMatrix(),C.$on("add_word_DAG",(function(t){return r.addWordDAG(t)})),C.$on("add_sentence_DAG",(function(t){return r.addSentenceDAG(t)})),C.$on("highlight_grid",(function(t){return r.highlightGrid(t)})),C.$on("brush_grid",(function(t){return r.brushGrid(t)})),endLoading();case 17:case"end":return e.stop()}}),e)})))()}},it=ot,st=(n("034f"),n("6544")),lt=n.n(st),ct=n("7496"),ut=n("8336"),ft=n("a609"),dt=n("b0af"),ht=n("99d9"),pt=n("ac7c"),gt=n("cc20"),yt=n("62ad"),vt=n("2b5d"),xt=n("a523"),mt=n("a75b"),wt=n("169a"),bt=n("132d"),_t=n("adda"),kt=n("67b6"),Ct=n("43a6"),Mt=n("0fd9"),Ot=n("b974"),St=n("1f4f"),At=n("ba0d"),jt=n("2fa4"),Rt=n("e0c7"),zt=n("8654"),It=n("71d9"),Wt=Object(F["a"])(it,a,o,!1,null,null,null),Gt=Wt.exports;lt()(Wt,{VApp:ct["a"],VBtn:ut["a"],VBtnToggle:ft["a"],VCard:dt["a"],VCardActions:ht["a"],VCardText:ht["b"],VCheckbox:pt["a"],VChip:gt["a"],VCol:yt["a"],VCombobox:vt["a"],VContainer:xt["a"],VContent:mt["a"],VDialog:wt["a"],VIcon:bt["a"],VImg:_t["a"],VRadio:kt["a"],VRadioGroup:Ct["a"],VRow:Mt["a"],VSelect:Ot["a"],VSimpleTable:St["a"],VSlider:At["a"],VSpacer:jt["a"],VSubheader:Rt["a"],VTextField:zt["a"],VToolbar:It["a"]}),r["a"].use(h["a"]);var Et={corpus_layers:null},Lt=new h["a"].Store({state:{server_url:"./",DAG:{},linechart:{},scatterplot:{},bubble:{left:40,top:10},viewbox:{overview:{width:712.7361450195312,height:440.5694580078125},linechart:{width:1433.4722900390625,height:446.5694580078125},network:{width:1433.4722900390625,height:578.1111450195312}},config:{linechart:{scale:.3,padding:20},DAG:{padding:{top:5,left:24}},network:{padding:{left:20,top:20,right:20,bottom:20},node_scale:.6,node_padding:20},data_table:{max_table_len:3e3,min_text_len:30,target_text_len:45},dialog_width:600,histogram_width:550,histogram_height:120,histogram_color:"gray"},color_candidates:[["#d7191c","#1a9641","#ff7f0e","#1f77b4","#e377c2","#9467bd","#8c564b"],["rgb(230, 159, 0)","rgb(86, 180, 233)","rgb(0, 158, 115)","rgb(240, 228, 66)","rgb(0, 114, 178)","rgb(213, 94, 0)","rgb(204, 121, 167)"]],color_scheme:["#d7191c","#1a9641","#ff7f0e","#1f77b4","#e377c2","#9467bd"],neuron_clusters:[],edges:[],showed_layers:[0,3,6,9,10,12],layers:[1,2,3,4,5,6,7,8,9,10,11,12],current_layers:[],current_viewtype:"sentence",layout:null,sentenceclusters:[],all_samples:[],hover_word:null,hover_timer:null,current_samples:[],word_indexs:{},word_index_pos:{},filtered_words:[],labels:[],filter_info:{},parameters:{},tooltip:{top:0,left:0,show:!1,content:""},selected_class:[1,0]},getters:{positiveColor:function(t){return t.color_scheme[t.selected_class[0]]},negativeColor:function(t){return t.color_scheme[t.selected_class[1]]},neutralColor:function(t){return"gray"},neutralColorGray:function(t){return"#777"},fontSizeRange:function(t){return[17,35]},getSample:function(t){return function(e){return t.all_samples[e]}},checkWordIndex:function(t){return function(e){return!!t.word_indexs[e]}},getLabelColor:function(t){return function(e){for(var n=0;n<t.labels.length;++n)if(t.labels[n].label==e)return t.color_scheme[n];return"gray"}},selected_label:function(t){return t.selected_class.map((function(e){return t.labels[e].label}))},getSamples:function(t){return function(e){var n,r=t.config.data_table.max_table_len,a=t.config.data_table.target_text_len;return n=e&&e.length>0?e.map((function(e){return t.all_samples[e]})).sort((function(t,e){return Math.abs(t.text.length-a)-Math.abs(e.text.length-a)})).slice(0,r):t.all_samples.filter((function(e){return e.text.length>t.config.data_table.min_text_len})).slice(0,r).sort((function(t,e){return Math.abs(t.text.length-a)-Math.abs(e.text.length-a)})),n}},getWordIdxs:function(t){return function(e){return t.word_indexs[e]}},view_samples:function(t){var e,n=new Set(t.current_samples.map((function(t){return t.index}))),r=new Set,a=Object(i["a"])(t.filtered_words);try{for(a.s();!(e=a.n()).done;){var o,l=e.value,c=Object(i["a"])(t.word_indexs[l]);try{for(c.s();!(o=c.n()).done;){var u=o.value;r.add(u),n.has(u)&&n.delete(u)}}catch(p){c.e(p)}finally{c.f()}}}catch(p){a.e(p)}finally{a.f()}n=Object(s["a"])(n),n.sort((function(t,e){return t-e}));var f=Object(s["a"])(r).concat(n);function d(e){var n=[];e=e.split(" ");var r,a=Object(i["a"])(e);try{for(a.s();!(r=a.n()).done;){var o,s=r.value,l=1,c=Object(i["a"])(t.filtered_words);try{for(c.s();!(o=c.n()).done;){var u=o.value;if(-1!=s.indexOf(u)){l=0;var f=s.indexOf(u);f>0&&n.push([s.slice(0,f),!1]),n.push([u,!0]),u.length+f<s.length&&n.push([s.slice(u.length+f),!1]);break}}}catch(p){c.e(p)}finally{c.f()}l&&n.push([s,!1])}}catch(p){a.e(p)}finally{a.f()}return n}var h=f.map((function(e){return t.all_samples[e]})).map((function(e){var n=d(e.text),r=e.score[t.selected_class[0]],a=e.score[t.selected_class[1]];return{index:e.index,text:n,pred:e.pred,label:e.label,score:r/(r+a),show_filter:!1}}));return r.size>0&&(h[0].show_filter=!0,h=h.slice(0,r.size).concat(t.filter_info.sentences.filter((function(e){return!r.has(e.index)&&-1!=e.text.indexOf(" ".concat(t.filtered_words[0]," "))&&e.index>=5e3})).map((function(t){return{index:t.index,text:d(t.text),pred:"N/A",label:t.label,score:"N/A",show_filter:!1}})).sort((function(t,e){return 60312==t.index?-1:60312==e.index?1:t.index-e.index}))).concat(h.slice(r.size))),h.slice(0,500)}},mutations:{addHoverTimer:function(t,e){clearTimeout(t.hover_timer),t.hover_timer=e},removeHoverTimer:function(t){clearTimeout(t.hover_timer)},setHoverWord:function(t,e){t.hover_word=e},updatePosition:function(t,e){var n=t.config.network.padding,r=e.network.width-n.left-n.right,a=e.network.height-n.top-n.bottom;t.bubble.width=e.bubble.width,t.bubble.height=e.bubble.height,t.linechart.padding=t.config.linechart.padding,t.linechart.width=e.linechart.width-t.linechart.padding,t.linechart.height=e.linechart.height-t.linechart.padding,t.linechart.x=t.linechart.padding,t.linechart.y=t.linechart.padding,t.DAG.width=r,t.DAG.height=a,t.DAG.x=t.config.DAG.padding.left,t.DAG.y=t.config.DAG.padding.top},setViewtype:function(t,e){t.current_viewtype=e},setScatterplot:function(t,e){t.scatterplot=e.data},setLayers:function(t,e){t.layers=e},calcEdges:function(t,e){R(t,e)},calcDAG:function(t){"word"==t.current_viewtype&&(W(t),this.commit("calcEdges",t.current_layers))},changeFilteredWord:function(t,e){var n=e.key,r=e.sentences,a=e.pos,o=e.neg,i=t.filtered_words.indexOf(n);-1!=i?t.filtered_words.splice(i,1):(t.filtered_words=[n],t.filter_info={sentences:r,pos:a,neg:o,word:n})},setNetwork:function(t,e){"sentence"==t.current_viewtype?t.layout=e.data.layout:"word"==t.current_viewtype&&(t.neuron_clusters=e.data.neuron_clusters,t.edges=e.data.edges)},setAllSamples:function(t,e){t.all_samples=e.sort((function(t,e){return t.id-e.id}))},setCurrentSamples:function(t,e){t.current_samples=e},setWordIndex:function(t,e){var n=e.key,r=e.idxs,a=e.pos;t.word_indexs[n]=r,t.word_index_pos[n]=a},showTooltip:function(t,e){var n=e.top,r=e.left,a=e.content;t.tooltip.top=n+10,t.tooltip.left=r+10,t.tooltip.content=a,t.tooltip.show=!0},setSelectedClass:function(t,e){var n=e.selection;if(n[1]>n[0]){var r=n[0];n[0]=n[1],n[1]=r}t.selected_class=n},setModelInfo:function(t,e){var n=e.matrix,r=e.labels,a=e.label_names,o=e.xi_values;t.labels=r.map((function(t,e){return{label:t,name:a[e]}})),t.matrix=n,o=o.map((function(t){return Math.abs(t)}));var i=Math.max.apply(Math,Object(s["a"])(o));o=o.map((function(t){return t/i})),t.parameters.xi_values=o,t.parameters.xi_range=[Math.min.apply(Math,Object(s["a"])(o)),Math.max.apply(Math,Object(s["a"])(o))]},hideTooltip:function(t){t.tooltip.show=!1}},actions:{changeCurrentSamples:function(t,e){return Object(l["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.commit,a=t.getters,r("setCurrentSamples",a.getSamples(e));case 2:case"end":return n.stop()}}),n)})))()},changeFilteredWord:function(t,e){return Object(l["a"])(regeneratorRuntime.mark((function n(){var r,a,o,i,s,l,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,a=t.state,n.next=3,y.a.post("".concat(a.server_url,"/api/word_sentences"),{word:e});case 3:o=n.sent,i=o.data,s=i.sentences,l=i.pos,c=i.neg,r("changeFilteredWord",{key:e,sentences:s,pos:l,neg:c});case 6:case"end":return n.stop()}}),n)})))()},fetchWordIndex:function(t,e){return Object(l["a"])(regeneratorRuntime.mark((function n(){var r,a,o,i,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.commit,a=t.state,!a.word_indexs[e]){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,y.a.post("".concat(a.server_url,"/api/word"),{word:e});case 5:o=n.sent,console.log(o),i=o.data.idxs,s=o.data.pos,r("setWordIndex",{key:e,idxs:i,pos:s});case 10:case"end":return n.stop()}}),n)})))()},fetchLayerInfo:function(t,e){return Object(l["a"])(regeneratorRuntime.mark((function n(){var r,a,o,i,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.commit,a=t.state,o=e.idxs,i=e.attrs,null!=o||null==Et.corpus_layers){n.next=6;break}s=Et.corpus_layers,n.next=12;break;case 6:return startLoading(),n.next=9,y.a.post("".concat(a.server_url,"/api/layers"),{idxs:o,attrs:i});case 9:s=n.sent,endLoading(),null==o&&(Et.corpus_layers=s);case 12:r("setLayers",s.data);case 13:case"end":return n.stop()}}),n)})))()},fetchDAG:function(t,e){return Object(l["a"])(regeneratorRuntime.mark((function n(){var r,a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,a=t.state,startLoading(),n.next=4,y.a.post("".concat(a.server_url,"/api/networks"),e);case 4:o=n.sent,r("setNetwork",o),r("calcDAG"),endLoading();case 8:case"end":return n.stop()}}),n)})))()},selectClass:function(t,e){return Object(l["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,a=t.state,startLoading(),n.next=4,y.a.post("".concat(a.server_url,"/api/select_class"),{selected:e});case 4:n.sent,r("setSelectedClass",{selection:e}),endLoading();case 7:case"end":return n.stop()}}),n)})))()},fetchMatrix:function(t){return Object(l["a"])(regeneratorRuntime.mark((function e(){var n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,r=t.state,startLoading(),e.next=4,y.a.post("".concat(r.server_url,"/api/model_info"),{});case 4:a=e.sent,n("setModelInfo",a.data),endLoading();case 7:case"end":return e.stop()}}),e)})))()},fetchAllSample:function(t){return Object(l["a"])(regeneratorRuntime.mark((function e(){var n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,r=t.state,t.getters,startLoading(),e.next=4,y.a.post("".concat(r.server_url,"/api/all_sentences"),{});case 4:a=e.sent,n("setAllSamples",a.data.sentences),endLoading();case 7:case"end":return e.stop()}}),e)})))()},fetchScatterplot:function(t){return Object(l["a"])(regeneratorRuntime.mark((function e(){var n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,r=t.state,startLoading(),e.next=4,y.a.post("".concat(r.server_url,"/api/scatterplot"),{});case 4:a=e.sent,n("setScatterplot",a),endLoading();case 7:case"end":return e.stop()}}),e)})))()}},modules:{}}),Dt=n("f309");r["a"].use(Dt["a"]);var Nt=new Dt["a"]({}),Tt=n("3d29"),Bt=n.n(Tt);n("9992");r["a"].use(Bt.a),r["a"].config.productionTip=!1,new r["a"]({store:Lt,vuetify:Nt,render:function(t){return t(Gt)}}).$mount("#app")},"5c87":function(t,e,n){"use strict";var r=n("f972"),a=n.n(r);a.a},"85ec":function(t,e,n){},"8d3c":function(t,e,n){t.exports=n.p+"static/img/figure1.f069d720.png"},a760:function(t,e,n){t.exports=n.p+"static/img/legend1.181e0cc3.png"},caadb:function(t,e,n){"use strict";var r=n("2db6"),a=n.n(r);a.a},f972:function(t,e,n){}});
//# sourceMappingURL=app.70061565.js.map